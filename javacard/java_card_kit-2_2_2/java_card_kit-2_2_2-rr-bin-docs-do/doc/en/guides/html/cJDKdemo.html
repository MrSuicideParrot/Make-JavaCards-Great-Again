<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html lang="en">
<head>
  <meta http-equiv="Content-Type"
 content="text/html; charset=ISO-8859-1">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <meta name="GENERATOR"
 content="Adobe FrameMaker 7.0/HTML Export Filter">
  <link rel="STYLESHEET" href="unx_unstr_styles.css"
 charset="ISO-8859-1" type="text/css">
  <meta name="DC.TITLE"
 content="Development Kit User's Guide, Java Card Platform, Version 2.2.2">
  <title>C H A P T E R 3 - Development Kit Samples and Demonstrations</title>
</head>
<body bgcolor="#ffffff">
<div>
<div class="navbar" align="center">
<table dir="ltr"
 summary="Navigation bar, includes the book title and navigation buttons"
 width="100%" cellpadding="0" cellspacing="0" border="0">
  <colgroup span="2" width="100%"><col id="1" span="1" width="50%"><col
 id="2" span="1" width="50%"></colgroup><tbody>
    <tr bgcolor="#cccccc">
      <td class="navbartitle" align="left" rowspan="1" colspan="1"
 abbr="ChapTitle">&nbsp;&nbsp;Development Kit User's Guide, Java Card
Platform, Version 2.2.2
      </td>
      <td valign="top" align="right" rowspan="1" colspan="1"
 abbr="NavButtons"><a href="index.html"><img src="shared/toc01.gif"
 title="Table Of Contents" alt="Table Of Contents" width="30"
 height="26" border="0"></a><a href="cJDKinstall.html"><img
 src="shared/prev01.gif" title="Previous Chapter" alt="Previous Chapter"
 width="30" height="26" border="0"></a><a href="cJDKjcwde.html"><img
 src="shared/next01.gif" title="Next Chapter" alt="Next Chapter"
 width="30" height="26" border="0"></a><a href="ix.html"><img
 src="shared/index01.gif" title="Book Index" alt="Book Index" width="30"
 height="26" border="0"></a>
      </td>
    </tr>
  </tbody>
</table>
<br>
<br>
</div>
</div>
<table dir="ltr" summary="Chapter Number" abbr="ChapNum" width="100%"
 border="0">
  <colgroup span="1" width="100%"><col id="1" span="1"></colgroup><tbody>
    <tr>
      <td align="right" class="ChapNumber"><span class="ChapNumPrefix"><a
 name="pgfId-1001510"></a>C H A P T E R </span>&nbsp;<span
 class="ChapNumNum">3</span><a name="21452"></a>
      </td>
    </tr>
  </tbody>
</table>
<table dir="ltr" summary="Chapter Title" abbr="ChapTitle" width="100%"
 border="0">
  <colgroup span="1" width="100%"><col id="1" span="1" width="100%"></colgroup><tbody>
    <tr>
      <td align="right" class="ChapTitle">
      <hr size="7" noshade="noshade"><a name="pgfId-1001512"></a><a
 name="62330"></a>Development Kit Samples and Demonstrations
      </td>
    </tr>
  </tbody>
</table>
<p class="Paragraph"><a name="pgfId-1001513"></a>This release includes
several demonstration programs that illustrate the use of the Java Card
API, and a scenario of post-manufacture installation.
</p>
<h2 class="Head1"><a name="pgfId-1001517"></a>
<div>
<hr align="left" size="6" width="15%" noshade="noshade"></div>
<a name="79331"></a>The Demonstrations<a name="marker-1001516"></a></h2>
<p class="Paragraph"><a name="pgfId-1001521"></a>Version 2.2.2 of the
development kit includes the following demonstration programs: </p>
<ul>
  <li class="Bullet1"><a name="pgfId-1001528"></a><strong
 class="Lead-In2para"><a href="cJDKdemo.html#54665" class="XRef">Demo 1</a>
(</strong><kbd class="Filename-Command">demo1</kbd><strong
 class="Lead-In2para">) - </strong>Illustrates the use of packages
masked into card ROM: <kbd class="Filename-Command">JavaPurse</kbd>, <kbd
 class="Filename-Command">JavaLoyalty</kbd>, <kbd
 class="Filename-Command">Wallet</kbd> and <kbd
 class="Filename-Command">SampleLibrary</kbd>.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1001532"></a><strong
 class="Lead-In2para"><a href="cJDKdemo.html#34243" class="XRef">Demo 2</a>
(</strong><kbd class="Filename-Command">demo2</kbd><strong
 class="Lead-In2para">) - </strong>Downloads these packages into the
C-language Java Card RE using the installer applet: <kbd
 class="Filename-Command">JavaPurse</kbd>, <kbd
 class="Filename-Command">JavaLoyalty</kbd>, <kbd
 class="Filename-Command">Wallet</kbd>, <kbd class="Filename-Command">SampleLibrary</kbd>,
    <kbd class="Filename-Command">RMIDemo</kbd>, <kbd
 class="Filename-Command">SecureRMIDemo</kbd>, and <kbd
 class="Filename-Command">photocard</kbd>. <kbd
 class="Filename-Command">demo2</kbd> also exercises the <kbd
 class="Filename-Command">JavaPurse</kbd>, <kbd
 class="Filename-Command">JavaLoyalty</kbd>, and <kbd
 class="Filename-Command">Wallet</kbd> applets.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1112439"></a><strong
 class="Lead-In2para"><a href="cJDKdemo.html#65322" class="XRef">Demo 2
Cryptography Demo</a> (</strong><kbd class="Filename-Command">demo2crypto</kbd><strong
 class="Lead-In2para">) - </strong>Similar to <kbd
 class="Filename-Command">demo2</kbd>, except it uses a version of <kbd
 class="Filename-Command">JavaPurse</kbd> that uses a DES MAC
algorithm.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1001540"></a><strong
 class="Lead-In2para"><a href="cJDKdemo.html#86125" class="XRef">Demo 3</a>
(</strong><kbd class="Filename-Command">demo3</kbd><strong
 class="Lead-In2para">) - </strong>Illustrates the second time
power-up of an already initialized mask. It uses the card state file
created by <kbd class="Filename-Command">demo2</kbd>.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1001548"></a><strong
 class="Lead-In2para"><a href="cJDKdemo.html#27897" class="XRef">Java
Card RMI Demo</a> (</strong><kbd class="Filename-Command">RMIDemo</kbd><strong
 class="Lead-In2para">) -</strong> Demonstrates the use of the Java
Card platform Remote Method Invocation (Java Card RMI) API. The basic
example used is a program that manages a counter remotely, and is able
to decrement, increment, and return the value of an account. On <kbd
 class="Filename-Command">cref</kbd>, <kbd class="Filename-Command">RMIDemo</kbd>
uses the card state file created by <kbd class="Filename-Command">demo2</kbd>.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1001552"></a><strong
 class="Lead-In2para"><a href="cJDKdemo.html#13760" class="XRef">Logical
Channels Demo</a> (</strong><kbd class="Filename-Command">channelDemo</kbd><strong
 class="Lead-In2para">) - </strong>Demonstrates the use of logical
channels which allows selecting multiple applets at the same time.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1001556"></a><strong
 class="Lead-In2para"><a href="cJDKdemo.html#92942" class="XRef">Object
Deletion Demo 1</a> (</strong><kbd class="Filename-Command">odDemo1</kbd><strong
 class="Lead-In2para">) - </strong>Demonstrates applet and package
deletion, as well as the object deletion mechanism which removes
unreachable objects.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1001560"></a><strong
 class="Lead-In2para"><a href="cJDKdemo.html#93003" class="XRef">Object
Deletion Demo 2</a> (</strong><kbd class="Filename-Command">odDemo2</kbd><strong
 class="Lead-In2para">) - </strong>Demonstrates package deletion and
checks that persistent memory has been returned to the memory manager.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1001564"></a><strong
 class="Lead-In2para"><a href="cJDKdemo.html#28577" class="XRef">Photo
Card Demo</a> (</strong><kbd class="Filename-Command">photocard</kbd><strong
 class="Lead-In2para">) -</strong> Demonstrates how to store images in
the large address space that is available in the 32-bit version of the
Java Card platform reference implementation, version 2.2.2. </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1043388"></a><strong
 class="Lead-In2para"><a href="cJDKdemo.html#38674" class="XRef">Secure
Java Card RMI Demo</a> (</strong><kbd class="Filename-Command">SecureRMIDemo</kbd><strong
 class="Lead-In2para">) - </strong>Similar to <kbd
 class="Filename-Command">RMIDemo</kbd>, but demonstrates additional
security at the transport level. It also uses the card state file
created on <kbd class="Filename-Command">cref</kbd> by <kbd
 class="Filename-Command">demo2</kbd>. </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1112462"></a><strong
 class="Lead-In2para"><a href="cJDKdemo.html#80637" class="XRef">Transit
System Demo</a></strong> (<a name="marker-1112460"></a><kbd
 class="Filename-Command">transit</kbd>) - Demonstrates a <a
 name="marker-1112461"></a>contactless card-based transit applet and
its interaction with a turnstile transit terminal and with a point of
sale terminal. </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1035956"></a><strong
 class="Lead-In2para"><a href="cJDKdemo.html#38180" class="XRef">Utility
APIs Demo Applet</a></strong> (<a name="marker-1035963"></a><kbd
 class="Filename-Command">BrokerApplet</kbd>) - Demonstrates the use of
the utility APIs in an applet to simulate stock trading and portfolio
management.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1063863"></a><strong
 class="Lead-In2para"><a href="cJDKdemo.html#48505" class="XRef">Password
Biometric Sample Application</a> (</strong><kbd class="Filename-Command">biometryDemo</kbd><a
 name="marker-1063862"></a><strong class="Lead-In2para">)</strong> -
Illustrates the use of the biometric APIs of type PASSWORD.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1112472"></a><strong
 class="Lead-In2para"><a href="cJDKdemo.html#36525" class="XRef">SignatureMessageRecovery
Demo</a> (sigMsgFullRec and sigMsgPartRec)</strong><a
 name="marker-1112470"></a><a name="marker-1112471"></a> - Demonstrates
message recovery.
  </li>
  <p class="Linebreak">
  </p>
</ul>
<h3 class="Head2"><a name="pgfId-1019043"></a><a name="55859"></a>Directories
and Files in the <kbd class="Filename-Command">demo</kbd> Directory<a
 name="marker-1019042"></a></h3>
<p class="Paragraph"><a name="pgfId-1092860"></a>The <kbd
 class="Filename-Command">demo</kbd> directory is located at <kbd
 class="Filename-Command">$JC_HOME/samples/src/demo</kbd> on the
Solaris or Linux platform and at <kbd class="Filename-Command">%JC_HOME%\samples\src\demo</kbd>
on the Microsoft Windows platform. The <kbd class="Filename-Command">demo</kbd>
directory contains the directories and files for the development kit
demonstrations, which are described in <a href="cJDKdemo.html#69151"
 class="XRef">TABLE 3-1</a> and <a href="cJDKdemo.html#46839"
 class="XRef">TABLE 3-2</a>.
</p>
<br>
<hr noshade="noshade" size="1">
<table class="TipNote" dir="ltr" width="100%" summary="TipNote">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td rowspan="1" colspan="1" abbr="TipNoteText">
      <p class="TipNote"><b class="TipNote">Note - </b><a
 name="pgfId-1057955"></a>Many of the directories listed in <a
 href="cJDKdemo.html#69151" class="XRef">TABLE 3-1</a> and <a
 href="cJDKdemo.html#46839" class="XRef">TABLE 3-2</a> contain a <kbd
 class="Filename-Command">_tmp</kbd> subdirectory. This subdirectory
contains intermediate temporary files needed to construct the final <kbd
 class="Filename-Command">*.scr</kbd> source files.
      </p>
      </td>
    </tr>
  </tbody>
</table>
<hr noshade="noshade" size="1">
<br>
<br>
<table class="Titled" border="1" bordercolorlight="#FFFFFF"
 bordercolordark="#000000" cellpadding="5" cellspacing="0" dir="ltr">
  <caption class="TableCaption"><a name="pgfId-1001601"> </a> TABLE
3-1 <a name="69151"> </a> Directories and Files in the <kbd
 class="Filename-Command"> demo </kbd> Directory </caption>
  <thead><tr>
    <th scope="col" rowspan="1" colspan="1" bgcolor="#cccccc">
    <p class="TableHead"><a name="pgfId-1001605"></a>Directories/Files
    </p>
    </th>
    <th scope="col" rowspan="1" colspan="1" bgcolor="#cccccc">
    <p class="TableHead"><a name="pgfId-1001607"></a>Description
    </p>
    </th>
  </tr>
  </thead>
  <tbody>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableTextCode"><a name="pgfId-1001609"></a>demo1 <br>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1001611"></a>Contains the
files required to run and verify <kbd class="Filename-Command">demo1</kbd>:
      </p>
      <ul>
        <li class="TableBullet"><a name="pgfId-1001613"></a><kbd
 class="Filename-Command">demo1.scr</kbd><strong class="Lead-In2para">
- </strong>Demonstration <kbd class="Filename-Command">apdutool</kbd>
script file.
        </li>
        <li class="TableBullet"><a name="pgfId-1001614"></a><kbd
 class="Filename-Command">demo1.scr.expected.out</kbd><strong
 class="Lead-In2para"> - </strong>For comparison with <kbd
 class="Filename-Command">apdutool</kbd> output when the demo is run.
        </li>
      </ul>
      </td>
    </tr>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableTextCode"><a name="pgfId-1001616"></a>demo2 <br>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1001618"></a>Contains the
files required to run and verify <kbd class="Filename-Command">demo2</kbd>
and <kbd class="Filename-Command">demo2crypto</kbd>:
      </p>
      <ul>
        <li class="TableBullet"><a name="pgfId-1001620"></a><kbd
 class="Filename-Command">demo2.scr</kbd>, <kbd
 class="Filename-Command">demo2crypto.scr</kbd><strong
 class="Lead-In2para"> - </strong>Demonstration <kbd
 class="Filename-Command">apdutool</kbd> script files.
        </li>
        <li class="TableBullet"><a name="pgfId-1001621"></a><kbd
 class="Filename-Command">demo2.scr.expected.out</kbd>, <kbd
 class="Filename-Command">demo2crypto.scr.expected.out </kbd><strong
 class="Lead-In2para">- </strong>For comparison with <kbd
 class="Filename-Command">apdutool</kbd> output when the demo is run.
        </li>
      </ul>
      <p class="TableText"><a name="pgfId-1001622"></a>&nbsp;
      </p>
      <p class="TableText"><a name="pgfId-1001623"></a>This directory
also contains the subdirectories for the demos that depend on the
output of <kbd class="Filename-Command">demo2</kbd>. For more
information on the contents of these subdirectories and the demos they
represent, see <em class="Z-Xref"><a href="cJDKdemo.html#46839"
 class="XRef">TABLE 3-2</a></em>.
      </p>
      </td>
    </tr>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableTextCode"><a name="pgfId-1001628"></a>demo3 <br>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1001630"></a>Contains the
files required to run and verify <kbd class="Filename-Command">demo3</kbd>:
      </p>
      <ul>
        <li class="TableBullet"><a name="pgfId-1001631"></a><kbd
 class="Filename-Command">demo3.scr</kbd><strong class="Lead-In2para">
- </strong>Demonstration <kbd class="Filename-Command">apdutool</kbd>
script file.
        </li>
        <li class="TableBullet"><a name="pgfId-1001632"></a><kbd
 class="Filename-Command">demo3.scr.expected.out</kbd><strong
 class="Lead-In2para"> - </strong>For comparison with <kbd
 class="Filename-Command">apdutool</kbd> output when the demo is run.
        </li>
      </ul>
      </td>
    </tr>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableTextCode"><a name="pgfId-1001642"></a>jcwde<br>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1001644"></a>Contains the
files required to run Java Card WDE:
      </p>
      <ul>
        <li class="TableBullet"><a name="pgfId-1001645"></a><kbd
 class="Filename-Command">jcwde.app</kbd><strong class="Lead-In2para">
- </strong>Lists all of the applets (and their AIDs) to be loaded into
the simulated mask for Java Card WDE.
        </li>
        <li class="TableBullet"><a name="pgfId-1113596"></a><kbd
 class="Filename-Command">jcwde_rmi.app</kbd><strong
 class="Lead-In2para"> and </strong><kbd class="Filename-Command">jcwde_securermi.app</kbd><strong
 class="Lead-In2para"> - </strong>Lists the contents of Java Card WDE
for running the <kbd class="Filename-Command">RMIDemo</kbd> and <kbd
 class="Filename-Command">SecureRMIDemo</kbd> respectively.
        </li>
        <li class="TableBullet"><a name="pgfId-1076054"></a><kbd
 class="Filename-Command">jcwde_transit.app</kbd> - Used to run the
transit demo using <kbd class="Filename-Command">jcwde</kbd>, but only
if you choose to modify the existing script to enable that.
        </li>
      </ul>
      </td>
    </tr>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableTextCode"><a name="pgfId-1001648"></a>logical_channels
      <br>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1001650"></a>Contains the
files required to run and verify the logical channels demo:
      </p>
      <ul>
        <li class="TableBullet"><a name="pgfId-1001651"></a><kbd
 class="Filename-Command">channel.scr</kbd><strong class="Lead-In2para">,
          </strong><kbd class="Filename-Command">channelDemo.scr</kbd>,
          <kbd class="Filename-Command">ChnDemo.scr</kbd><strong
 class="Lead-In2para"> -</strong>Demonstration <kbd
 class="Filename-Command">apdutool</kbd> script files.
        </li>
        <li class="TableBullet"><a name="pgfId-1001652"></a><kbd
 class="Filename-Command">channelDemo.scr.expected.out</kbd><strong
 class="Lead-In2para"> - </strong>For comparison with <kbd
 class="Filename-Command">apdutool</kbd> output when the demo is run.
        </li>
      </ul>
      </td>
    </tr>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableTextCode"><a name="pgfId-1001654"></a>misc<br>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1001656"></a><kbd
 class="Filename-Command">Footer.scr</kbd><strong class="Lead-In2para">,
      </strong><kbd class="Filename-Command">Header.scr</kbd><strong
 class="Lead-In2para"> - </strong>Scripts to terminate and initialize
the session, respectively.
      </p>
      </td>
    </tr>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableTextCode"><a name="pgfId-1001658"></a>object_deletion
      <br>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1001660"></a>Contains the
files required to run and verify <kbd class="Filename-Command">odDemo1</kbd>
and <kbd class="Filename-Command">odDemo2</kbd>:
      </p>
      <ul>
        <li class="TableBullet"><a name="pgfId-1001661"></a><kbd
 class="Filename-Command">packageA.scr</kbd><strong class="Lead-In2para">,
          </strong><kbd class="Filename-Command">packageB.scr</kbd><strong
 class="Lead-In2para">, </strong><kbd class="Filename-Command">packageC.scr</kbd><strong
 class="Lead-In2para"> - </strong>Intermediate script files for
building the final <br>
          <kbd class="Filename-Command">odDemo1-*.scr</kbd> files. </li>
        <li class="TableBullet"><a name="pgfId-1001662"></a><kbd
 class="Filename-Command">odDemo1-1.scr</kbd><strong
 class="Lead-In2para">, </strong><kbd class="Filename-Command">odDemo1-2.scr</kbd><strong
 class="Lead-In2para">, <br>
          </strong><kbd class="Filename-Command">odDemo1-3.scr</kbd><strong
 class="Lead-In2para"> - </strong>Demonstration <kbd
 class="Filename-Command">apdutool</kbd> script files.
        </li>
        <li class="TableBullet"><a name="pgfId-1001663"></a><kbd
 class="Filename-Command">od1.scr</kbd><strong class="Lead-In2para">, </strong><kbd
 class="Filename-Command">od2.scr</kbd><strong class="Lead-In2para">, </strong><kbd
 class="Filename-Command">od2-2.scr</kbd><strong class="Lead-In2para">,
          </strong><kbd class="Filename-Command">od3.scr</kbd><strong
 class="Lead-In2para">,</strong> <br>
          <kbd class="Filename-Command">od3-2.scr</kbd> <strong
 class="Lead-In2para">- </strong>Script files used for building the <br>
          <kbd class="Filename-Command">odDemo1-*.scr</kbd> files.
        </li>
        <li class="TableBullet"><a name="pgfId-1001664"></a><kbd
 class="Filename-Command">odDemo1-1.scr.expected.out</kbd><strong
 class="Lead-In2para">, <br>
          </strong><kbd class="Filename-Command">odDemo1-2.scr.expected.out</kbd><strong
 class="Lead-In2para">, <br>
          </strong><kbd class="Filename-Command">odDemo1-3.scr.expected.out</kbd><strong
 class="Lead-In2para">, </strong><kbd class="Filename-Command">odDemo2.scr.expected.out</kbd><strong
 class="Lead-In2para"> - </strong>For comparison with <kbd
 class="Filename-Command">apdutool</kbd> output when the demos are run.
        </li>
      </ul>
      </td>
    </tr>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableTextCode"><a name="pgfId-1046780"></a>utilitydemo<br>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1046953"></a>Contains files
required to run the Utility APIs demo.
      </p>
      <ul>
        <li class="TableBullet"><a name="pgfId-1046954"></a><kbd
 class="Filename-Command">UtilityDemoFooter.scr</kbd> - Script to build
the installation script.
        </li>
        <li class="TableBullet"><a name="pgfId-1046955"></a><kbd
 class="Filename-Command">utilitydemo.scr.expected.out</kbd> - For
comparison with <kbd class="Filename-Command">apdutool</kbd> output
when the demo is run.
        </li>
      </ul>
      </td>
    </tr>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableTextCode"><a name="pgfId-1025070"></a>transit<br>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1064761"></a>Contains the
files to run the transit system demo:
      </p>
      <ul>
        <li class="TableBullet"><a name="pgfId-1064762"></a><kbd
 class="Filename-Command">TransitDemo</kbd> or <kbd
 class="Filename-Command">TransitDemo.bat</kbd> - Shell script and
batch file to run the pre-scripted transit demo.
        </li>
        <li class="TableBullet"><a name="pgfId-1064763"></a><kbd
 class="Filename-Command">POSTerminal</kbd> or <kbd
 class="Filename-Command">POSTerminal.bat</kbd> - Shell script and
batch file to run the Point Of Sale Terminal.
        </li>
        <li class="TableBullet"><a name="pgfId-1064764"></a><kbd
 class="Filename-Command">TransitTerminal</kbd> or <kbd
 class="Filename-Command">TransitTerminal.bat</kbd> - Shell script and
batch file to run the turnstile transit terminal.
        </li>
        <li class="TableBullet"><a name="pgfId-1064755"></a><kbd
 class="Filename-Command">TransitDemoFooter*</kbd> - Scripts to build
the installation scripts. </li>
        <li class="TableBullet"><a name="pgfId-1064744"></a><kbd
 class="Filename-Command">TransitDemo.expected.out</kbd> - For
comparison with demo output. </li>
      </ul>
      </td>
    </tr>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableTextCode"><a name="pgfId-1019052"></a>Password
Biometric Sample Application<br>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1064779"></a>Contains four
files:
      </p>
      <ul>
        <li class="TableBullet"><a name="pgfId-1065147"></a><kbd
 class="Filename-Command">biometryDemo.scr</kbd> - script to run <kbd
 class="Filename-Command">biometryDemo</kbd>.
        </li>
        <li class="TableBullet"><a name="pgfId-1065138"></a><kbd
 class="Filename-Command">biometryEnroll.scr</kbd> - Used to build <kbd
 class="Filename-Command">biometryDemo.sc</kbd>r.
        </li>
        <li class="TableBullet"><a name="pgfId-1065139"></a><kbd
 class="Filename-Command">biometryMatch.scr</kbd> - Used to build <kbd
 class="Filename-Command">biometryDemo.scr</kbd>.
        </li>
        <li class="TableBullet"><a name="pgfId-1065137"></a><kbd
 class="Filename-Command">biometryDemo.scr.expected.out</kbd> - For
comparison with <kbd class="Filename-Command">apdutool</kbd> output
when the demo is run.
        </li>
      </ul>
      </td>
    </tr>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableTextCode"><a name="pgfId-1019492"></a>SignatureMessageRecovery<br>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1113622"></a>Contains six
files demonstrating message recovery:
      </p>
      <ul>
        <li class="TableBullet"><a name="pgfId-1113623"></a><kbd
 class="Filename-Command">SignAndFullRec.scr</kbd> - Used to build <kbd
 class="Filename-Command">sigMsgFullRec.scr</kbd>. </li>
        <li class="TableBullet"><a name="pgfId-1065175"></a><kbd
 class="Filename-Command">SignAndPartRec.scr</kbd> - Used to build <kbd
 class="Filename-Command">sigMsgPartRec.scr</kbd>.
        </li>
        <li class="TableBullet"><a name="pgfId-1065170"></a><kbd
 class="Filename-Command">sigMsgFullRec.scr</kbd> - Used to run the <kbd
 class="Filename-Command">sigMsgFullRec</kbd> demo.
        </li>
        <li class="TableBullet"><a name="pgfId-1058657"></a><kbd
 class="Filename-Command">sigMsgPartRec.scr</kbd> - Used to run the <kbd
 class="Filename-Command">sigMsgPartRec</kbd> demo.
        </li>
        <li class="TableBullet"><a name="pgfId-1065154"></a><kbd
 class="Filename-Command">sigMsgFullRec.scr.expected.out</kbd> - For
comparison with <kbd class="Filename-Command">apdutool</kbd> output
when the <kbd class="Filename-Command">apdutool</kbd> is run using <kbd
 class="Filename-Command">sigMsgFullRec.scr.</kbd>
        </li>
        <li class="TableBullet"><a name="pgfId-1065161"></a><kbd
 class="Filename-Command">sigMsgPartRec.scr.expected.out</kbd> - For
comparison with <kbd class="Filename-Command">apdutool</kbd> output
when the <kbd class="Filename-Command">apdutool</kbd> is run using <kbd
 class="Filename-Command">sigMsgPartRec.scr</kbd>
        </li>
      </ul>
      </td>
    </tr>
  </tbody>
</table>
<br>
<p class="Paragraph"><a name="pgfId-1001677"></a>Several of the
development kit demonstrations use the output generated by the <kbd
 class="Filename-Command">demo2</kbd> demonstration. These
demonstrations are stored in subdirectories of <kbd
 class="Filename-Command">demo2</kbd>. The <kbd
 class="Filename-Command">demo2</kbd> directory also contains the files
that the demos need to run <kbd class="Filename-Command">JavaPurse</kbd>,
<kbd class="Filename-Command">JavaLoyalty</kbd>, and <kbd
 class="Filename-Command">Wallet</kbd>. The demonstrations and
subdirectories contained in <kbd class="Filename-Command">demo2</kbd>
are described in <a href="cJDKdemo.html#46839" class="XRef">TABLE 3-2</a>.
</p>
<br>
<table class="Titled" border="1" bordercolorlight="#FFFFFF"
 bordercolordark="#000000" cellpadding="5" cellspacing="0" dir="ltr">
  <caption class="TableCaption"><a name="pgfId-1001685"> </a> TABLE
3-2 <a name="46839"> </a> Subdirectories and Demonstrations in the <kbd
 class="Filename-Command"> demo2 </kbd> Directory </caption>
  <thead><tr>
    <th scope="col" rowspan="1" colspan="1" bgcolor="#cccccc">
    <p class="TableHead"><a name="pgfId-1001689"></a>Subdirectories
    </p>
    </th>
    <th scope="col" rowspan="1" colspan="1" bgcolor="#cccccc">
    <p class="TableHead"><a name="pgfId-1001691"></a>Description
    </p>
    </th>
  </tr>
  </thead>
  <tbody>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableTextCode"><a name="pgfId-1001693"></a><kbd
 class="Filename-Command">javapurse</kbd>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1001695"></a>Contains the
files required to run the demos that use <kbd class="Filename-Command">JavaPurse</kbd>:
      </p>
      <ul>
        <li class="TableBullet"><a name="pgfId-1001696"></a><kbd
 class="Filename-Command">AppletTest.scr</kbd><strong
 class="Lead-In2para">, </strong><kbd class="Filename-Command">AppletTestCrypto.scr</kbd><strong
 class="Lead-In2para"> - </strong>Downloads and executes the
demonstration applets.
        </li>
        <li class="TableBullet"><a name="pgfId-1001697"></a><kbd
 class="Filename-Command">_tmp/JavaLoyalty.scr</kbd><strong
 class="Lead-In2para"> - </strong>Installation script for the <kbd
 class="Filename-Command">JavaLoyalty</kbd> Java Card applet.
        </li>
        <li class="TableBullet"><a name="pgfId-1001698"></a><kbd
 class="Filename-Command">_tmp/JavaPurse.scr</kbd>, <kbd
 class="Filename-Command">_tmp/JavaPurseCrypto.scr</kbd><strong
 class="Lead-In2para"> -</strong> Installation scripts for the <kbd
 class="Filename-Command">JavaPurse</kbd> Java Card applet.
        </li>
        <li class="TableBullet"><a name="pgfId-1001699"></a><kbd
 class="Filename-Command">_tmp/SampleLibrary.scr</kbd><strong
 class="Lead-In2para"> - </strong>Installation script for the <kbd
 class="Filename-Command">SampleLibrary</kbd> library package.
        </li>
      </ul>
      </td>
    </tr>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableTextCode"><a name="pgfId-1001701"></a><kbd
 class="Filename-Command">photocard</kbd>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1001703"></a>Contains the
files required to run and verify the photo card demo:
      </p>
      <ul>
        <li class="TableBullet"><a name="pgfId-1001704"></a><kbd
 class="Filename-Command">photocard</kbd><strong class="Lead-In2para">,</strong>
          <kbd class="Filename-Command">photocard.bat</kbd><strong
 class="Lead-In2para"> - </strong>Script/batch file to run the photo
card demo.
        </li>
        <li class="TableBullet"><a name="pgfId-1001705"></a><kbd
 class="Filename-Command">_tmp/photocard.scr</kbd><strong
 class="Lead-In2para"> - </strong>Installation script for the photo
card applet package.
        </li>
        <li class="TableBullet"><a name="pgfId-1001706"></a><kbd
 class="Filename-Command">photocard.scr.expected.out</kbd><strong
 class="Lead-In2para"> - </strong>For comparison with <kbd
 class="Filename-Command">apdutool</kbd> output when the demo is run.
        </li>
        <li class="TableBullet"><a name="pgfId-1101923"></a><kbd
 class="Filename-Command">photocard.scr.expected.out.not_crypto</kbd> -
For comparison with <kbd class="Filename-Command">apdutool</kbd>
output when the demo is run using <kbd class="Filename-Command">cref</kbd>
in a non-crypto version.
        </li>
        <li class="TableBullet"><a name="pgfId-1001707"></a><kbd
 class="Filename-Command">*.gif</kbd><strong class="Lead-In2para"> </strong>files<strong
 class="Lead-In2para"> - </strong>Sample photo files.
        </li>
      </ul>
      </td>
    </tr>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableTextCode"><a name="pgfId-1001710"></a><kbd
 class="Filename-Command">rmi</kbd>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1001712"></a>Contains the
files required to run and verify <kbd class="Filename-Command">RMIDemo</kbd>
and <kbd class="Filename-Command">SecureRMIDemo</kbd>:
      </p>
      <ul>
        <li class="TableBullet"><a name="pgfId-1001713"></a><kbd
 class="Filename-Command">rmidemo</kbd><strong class="Lead-In2para"> </strong>or<strong
 class="Lead-In2para"> </strong><kbd class="Filename-Command">rmidemo.bat</kbd>,
          <kbd class="Filename-Command">securermidemo</kbd><strong
 class="Lead-In2para"> </strong>or<strong class="Lead-In2para"> </strong><kbd
 class="Filename-Command">securermidemo.bat</kbd><strong
 class="Lead-In2para"> - </strong>Shell scripts and batch files for
running the Java Card RMI and secure Java Card RMI demos, respectively.
        </li>
        <li class="TableBullet"><a name="pgfId-1001714"></a><kbd
 class="Filename-Command">rmidemo.scr.expected.out</kbd><strong
 class="Lead-In2para">, </strong><kbd class="Filename-Command">securermidemo.scr.expected.out</kbd><strong
 class="Lead-In2para"> - </strong>For comparison with <kbd
 class="Filename-Command">apdutool</kbd> output when the demos are run.
        </li>
        <li class="TableBullet"><a name="pgfId-1001715"></a><kbd
 class="Filename-Command">_tmp/RMIDemo.scr</kbd>, <kbd
 class="Filename-Command">_tmp/SecureRMIDemo.scr</kbd><strong
 class="Lead-In2para"> - </strong>Installation scripts to install the <kbd
 class="Filename-Command">RMIDemo</kbd> and <kbd
 class="Filename-Command">SecureRMIDemo</kbd> applet packages,
respectively.
        </li>
      </ul>
      </td>
    </tr>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableTextCode"><a name="pgfId-1001718"></a><kbd
 class="Filename-Command">wallet</kbd>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1001720"></a>Contains the
file required to run the demos that use the <kbd
 class="Filename-Command">Wallet</kbd> applet:
      </p>
      <p class="TableText"><a name="pgfId-1001721"></a><kbd
 class="Filename-Command">_tmp/Wallet.scr </kbd><strong
 class="Lead-In2para">- </strong>Installation script for the <kbd
 class="Filename-Command">Wallet</kbd> applet package.
      </p>
      </td>
    </tr>
  </tbody>
</table>
<br>
<h2 class="Head1"><a name="pgfId-1001727"></a>
<div>
<hr align="left" size="6" width="15%" noshade="noshade"></div>
<a name="36361"></a>Preliminaries for Rebuilding the Demos</h2>
<p class="Paragraph"><a name="pgfId-1001728"></a>Except for the <kbd
 class="Filename-Command">transit</kbd> and Utility APIs Demo Applet
demos, all the demo programs in the binary release are prebuilt. If you
make any changes to the demos, the following sections describe how you
can rebuild them. </p>
<h3 class="Head2"><a name="pgfId-1001732"></a>Building <a
 name="marker-1001730"></a>Samples</h3>
<p class="Paragraph"><a name="pgfId-1041850"></a>Ant script files are
provided to build the samples. The Ant scripts are invoked by the shell
script <kbd class="Filename-Command">$JC_HOME/samples/build_samples</kbd>
on Solaris or Linux platforms or the batch file <kbd
 class="Filename-Command">%JC_HOME%\samples\build_samples.bat</kbd> on
the Microsoft Windows platform. To understand what is going on behind
the scenes, it is very instructive to look at these scripts.
</p>
<h4 class="Head3"><a name="pgfId-1001744"></a>Running the Build Script</h4>
<p class="Paragraph"><a name="pgfId-1001745"></a>By default, the build
script in the binary release produces a 32-bit version of <kbd
 class="Filename-Command">cref</kbd> that supports dual interfaces of
T=CL and T=1 protocols. </p>
<p class="Paragraph"><a name="pgfId-1092925"></a>Following is the
command line syntax for the build script:
</p>
<pre class="Codeline"><a name="pgfId-1001746"></a>build_samples options<br></pre>
<p class="Paragraph"><a name="pgfId-1001751"></a><a
 href="cJDKdemo.html#44767" class="XRef">TABLE 3-3</a> shows the
possible values for options. </p>
<br>
<table class="Titled" border="1" bordercolorlight="#FFFFFF"
 bordercolordark="#000000" cellpadding="5" cellspacing="0" dir="ltr">
  <caption class="TableCaption"><a name="pgfId-1001755"> </a> TABLE
3-3 <a name="44767"> </a> build_samples Command Line Options </caption>
  <thead><tr>
    <th scope="col" rowspan="1" colspan="1" bgcolor="#cccccc">
    <p class="TableHead"><a name="pgfId-1001760"></a>Value of <i
 class="EquationVariables">options</i>
    </p>
    </th>
    <th scope="col" rowspan="1" colspan="1" bgcolor="#cccccc">
    <p class="TableHead"><a name="pgfId-1001762"></a>Description
    </p>
    </th>
  </tr>
  </thead>
  <tbody>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1001764"></a><kbd
 class="Filename-Command">-clean</kbd>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1001766"></a>Removes all
files produced by the script.
      </p>
      </td>
    </tr>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1001768"></a><kbd
 class="Filename-Command">-help</kbd>
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1001770"></a>Prints a help
message and exits.
      </p>
      </td>
    </tr>
  </tbody>
</table>
<br>
<h4 class="Head3"><a name="pgfId-1001792"></a>Setting Environment
Variables<a name="marker-1001791"></a></h4>
<p class="Paragraph"><a name="pgfId-1001793"></a>The <kbd
 class="Filename-Command">build_samples</kbd> script uses the
environment variable <kbd class="Filename-Command">JAVA_HOME</kbd>. To
correctly set this environment variable, refer to <a
 href="cJDKinstall.html#71588" class="XRef">Setting Environment
Variables for the Solaris or Linux Platform</a> or <a
 href="cJDKinstall.html#16556" class="XRef">Setting Environment
Variables for Microsoft Windows Platform</a>.
</p>
<h2 class="Head1"><a name="pgfId-1001819"></a>
<div>
<hr align="left" size="6" width="15%" noshade="noshade"></div>
Building the Sample <a name="marker-1001818"></a>Applets</h2>
<p class="Paragraph"><a name="pgfId-1001836"></a>Run the script without
parameters to build the samples
</p>
<pre class="Codeline"><a name="pgfId-1001838"></a>build_samples <br></pre>
<h3 class="Head2"><a name="pgfId-1001840"></a>Preparing to Compile the
Sample <a name="marker-1001839"></a>Applets</h3>
<p class="Paragraph"><a name="pgfId-1027742"></a>This section details
the steps taken by the Ant script and also provides manual commands, if
you choose to perform these steps manually.
</p>
<p class="Step1"><a name="pgfId-1027746"></a> 1. A <kbd
 class="Filename-Command">classes</kbd> directory is created as a peer
to <kbd class="Filename-Command">src</kbd> under the <kbd
 class="Filename-Command">samples</kbd> directory.
</p>
<p class="Step1-"><a name="pgfId-1001848"></a> 2. The Java Card API
export files are copied to the <kbd class="Filename-Command">classes</kbd>
directory. </p>
<h3 class="Head2"><a name="pgfId-1001850"></a>Compiling the Sample
Applets<a name="marker-1001849"></a></h3>
<p class="Paragraph"><a name="pgfId-1001851"></a>The next step is to
compile the Java programming language sources for the sample applets.
For example, from the <kbd class="Filename-Command">samples</kbd>
directory, issue the following command:
</p>
<p class="Paragraph"><a name="pgfId-1001855"></a>Solaris or Linux
platform:
</p>
<pre class="Codeline"><a name="pgfId-1001856"></a>javac -g -classpath ./classes:../lib/api.jar:../lib/installer.jar src/com/sun/javacard/samples/HelloWorld/*.java <br></pre>
<p class="Paragraph"><a name="pgfId-1001860"></a>Microsoft Windows
platform:
</p>
<pre class="Codeline"><a name="pgfId-1001861"></a>javac -g -classpath .\classes;..\lib\api.jar;..\lib\installer.jar src\com\sun\javacard\samples\HelloWorld\*.java <br></pre>
<p class="Paragraph"><a name="pgfId-1001862"></a>where: </p>
<ul>
  <li class="Bullet1"><a name="pgfId-1001863"></a><kbd
 class="Filename-Command">api.jar</kbd> contains the Java Card API
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1-"><a name="pgfId-1001864"></a><kbd
 class="Filename-Command">installer.jar</kbd> contains the installer
applet
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1-"><a name="pgfId-1001865"></a>the <kbd
 class="Filename-Command">classes</kbd> directory is required for
packages that import other sample packages
  </li>
  <p class="Linebreak">
  </p>
</ul>
<h3 class="Head2"><a name="pgfId-1001867"></a>Converting the Class Files<a
 name="marker-1001866"></a></h3>
<p class="Paragraph"><a name="pgfId-1001868"></a>The next step is to
convert the Java programming language class files.
</p>
<p class="Paragraph"><a name="pgfId-1001869"></a>Conversion parameters
for each package are specified in a configuration file.
</p>
<p class="Paragraph"><a name="pgfId-1001870"></a>For example, a
configuration file contains the following items:
</p>
<pre class="Codeline"><a name="pgfId-1001871"></a>-out EXP JCA CAP<br></pre>
<pre class="Codeline"><a name="pgfId-1001872"></a>-exportpath .<br></pre>
<pre class="Codeline"><a name="pgfId-1001873"></a>-applet  0xa0:0x0:0x0:0x0:0x62:0x3:0x1:0xc:0x1:0x1<br></pre>
<pre class="Codeline"><a name="pgfId-1001874"></a>com.sun.javacard.samples.HelloWorld.HelloWorld<br></pre>
<pre class="Codeline"><a name="pgfId-1001875"></a>com.sun.javacard.samples.HelloWorld<br></pre>
<pre class="Codeline"><a name="pgfId-1001876"></a>0xa0:0x0:0x0:0x0:0x62:0x3:0x1:0xc:0x1 1.0<br></pre>
<p class="Paragraph"><a name="pgfId-1001877"></a>In this example, the
converter outputs three kinds of files: export (<kbd
 class="Filename-Command">*.exp</kbd>), CAP (<kbd
 class="Filename-Command">*.cap</kbd>) and Java Card Assembly (<kbd
 class="Filename-Command">*.jca</kbd>) files. </p>
<p class="Paragraph"><a name="pgfId-1001882"></a>For more information
about the converter tool, refer to <a href="cJDKconverter.html#62885"
 class="XRef">Chapter 5</a>.
</p>
<h3 class="Head2"><a name="pgfId-1001884"></a>Running <kbd
 class="Filename-Command">scriptgen</kbd> to Generate Script Files<a
 name="marker-1001883"></a></h3>
<p class="Paragraph"><a name="pgfId-1001885"></a>Generate script files
for <kbd class="Filename-Command">apdutool</kbd> using the <kbd
 class="Filename-Command">scriptgen</kbd> tool. This step must be done
for each package to be downloaded. For example: </p>
<pre class="Codeline"><a name="pgfId-1001886"></a>scriptgen -o JavaLoyalty.scr ./classes/com/sun/javacard/samples/JavaLoyalty/javacard/JavaLoyalty.cap <br></pre>
<p class="Paragraph"><a name="pgfId-1001887"></a>The new scripts are
included into the demonstration scripts. For example, <kbd
 class="Filename-Command">demo2.scr</kbd> file is composed of these
scripts: </p>
<ul>
  <li class="Bullet1"><a name="pgfId-1001889"></a><kbd
 class="Filename-Command">Header.scr</kbd><strong class="Lead-In2para">
-</strong> Script that initializes the session.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1001890"></a><kbd
 class="Filename-Command">SampleLibrary.scr</kbd><strong
 class="Lead-In2para">, </strong><kbd class="Filename-Command">JavaLoyalty.scr</kbd><strong
 class="Lead-In2para">, </strong><kbd class="Filename-Command">JavaPurse.scr</kbd><strong
 class="Lead-In2para">, </strong><kbd class="Filename-Command">Wallet.scr</kbd><strong
 class="Lead-In2para">, </strong><kbd class="Filename-Command">RMIDemo.scr</kbd><strong
 class="Lead-In2para">, </strong><kbd class="Filename-Command">SecureRMIDemo.scr</kbd><strong
 class="Lead-In2para">, </strong><kbd class="Filename-Command">photocard.scr</kbd><strong
 class="Lead-In2para"> - </strong>Package installation scripts. </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1001891"></a><kbd
 class="Filename-Command">AppletTest.scr</kbd><strong
 class="Lead-In2para"> - </strong>Script that creates the <kbd
 class="Filename-Command">JavaLoyalty</kbd>, <kbd
 class="Filename-Command">JavaPurse</kbd>, <kbd
 class="Filename-Command">Wallet</kbd>, <kbd class="Filename-Command">JavaPurseCrypto</kbd>,
    <kbd class="Filename-Command">RMIDemo</kbd>, and <kbd
 class="Filename-Command">SecureRMIDemo</kbd> applets so that you can
see each of them invoked when the simulation is run. <kbd
 class="Filename-Command">AppletTest.scr</kbd> also exercises the <kbd
 class="Filename-Command">JavaLoyalty.scr</kbd>, <kbd
 class="Filename-Command">JavaPurse.scr</kbd>, and <kbd
 class="Filename-Command">Wallet.scr</kbd> applets.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1001892"></a><kbd
 class="Filename-Command">Footer.scr</kbd><strong class="Lead-In2para">
- </strong>Script that terminates the session.
  </li>
  <p class="Linebreak">
  </p>
</ul>
<br>
<hr noshade="noshade" size="1">
<table class="TipNote" dir="ltr" width="100%" summary="TipNote">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td rowspan="1" colspan="1" abbr="TipNoteText">
      <p class="TipNote"><b class="TipNote">Note - </b><a
 name="pgfId-1020075"></a>The script files for the demonstrations use
the <kbd class="Filename-Command">output off;</kbd> <kbd
 class="Filename-Command">apdutool</kbd> directive to suppress the
logging of CAP file download APDU commands to the output log file, and
the <kbd class="Filename-Command">output on;</kbd> directive to enable
the logging of other commands. To enable logging of package download
commands, comment out the <kbd class="Filename-Command">output off;</kbd>
directive in the script file <kbd class="Filename-Command">Header.scr</kbd>
and run the <kbd class="Filename-Command">build_samples</kbd> script.
      </p>
      </td>
    </tr>
  </tbody>
</table>
<hr noshade="noshade" size="1">
<br>
<h2 class="Head1"><a name="pgfId-1064496"></a>
<div>
<hr align="left" size="6" width="15%" noshade="noshade"></div>
Running the Demonstrations</h2>
<p class="Paragraph"><a name="pgfId-1020085"></a>The following sections
describe the development kit demonstrations and how to run them.
</p>
<p class="Paragraph"><a name="pgfId-1002009"></a>A demonstration can
use a card EEPROM image created by another demonstration. The <kbd
 class="Filename-Command">cref</kbd> command line option <kbd
 class="Filename-Command">-o &lt;filename&gt;</kbd> lets you save the
EEPROM image into a file after a simulated card session. The option <kbd
 class="Filename-Command">-i &lt;filename&gt;</kbd> restores the image
from the file for a new card session. For more information, see <a
 href="cJDKc-jcre.html#56321" class="XRef">Chapter 10</a>.
</p>
<h3 class="Head2"><a name="pgfId-1002037"></a><a name="54665"></a>Demo 1<a
 name="marker-1003916"></a></h3>
<p class="Paragraph"><a name="pgfId-1002038"></a>The Demo 1
demonstration, <kbd class="Filename-Command">demo1</kbd>, exercises
the <kbd class="Filename-Command">JavaPurse</kbd>, <kbd
 class="Filename-Command">JavaLoyalty</kbd>, and <kbd
 class="Filename-Command">Wallet</kbd> applets by simulating
transactions where amounts are credited and debited from the card. The
demonstration begins by powering up the Java Card technology-enabled
smart card and creating the applets <kbd class="Filename-Command">JavaPurse</kbd>,
<kbd class="Filename-Command">JavaLoyalty</kbd>, and <kbd
 class="Filename-Command">Wallet</kbd>. </p>
<p class="Paragraph"><a name="pgfId-1002039"></a>The <kbd
 class="Filename-Command">JavaPurse</kbd> applet demonstrates a simple
electronic cash application. The applet is selected and initialized
with various parameters such as the Purse ID, the expiration date of
the card, the Master and User PINs, maximum balance, and maximum
transaction. Transaction operations perform the actual debits and
credits to the electronic purse. If a configured loyalty applet is
assigned for the CAD performing the transaction, <kbd
 class="Filename-Command">JavaPurse</kbd> communicates with it to grant
loyalty points. In this case, <kbd class="Filename-Command">JavaLoyalty</kbd>
is the provided loyalty applet. </p>
<p class="Paragraph"><a name="pgfId-1002040"></a>A number of
transaction sessions are simulated where amounts are credited and
debited from the card. In an additional session, transactions with
intentional errors are attempted to demonstrate the security features
of the card. </p>
<p class="Paragraph"><a name="pgfId-1002041"></a>The <kbd
 class="Filename-Command">JavaLoyalty</kbd> applet is designed to
interact with the <kbd class="Filename-Command">JavaPurse</kbd>
applet, and to demonstrate the use of shareable interfaces. The
shareable <kbd class="Filename-Command">JavaLoyaltyInterface</kbd> is
defined in a separate library package, <kbd class="Filename-Command">com.sun.javacard.SampleLibrary</kbd>.
</p>
<p class="Paragraph"><a name="pgfId-1002042"></a><kbd
 class="Filename-Command">JavaLoyalty</kbd> is a minimalistic loyalty
applet. It is registered with <kbd class="Filename-Command">JavaPurse</kbd>
when a Parameter Update APDU command with an appropriate parameter tag
is executed, and when the AID part of the parameter corresponds to the
AID of the <kbd class="Filename-Command">JavaLoyalty</kbd> applet. The
applet contains a <kbd class="Filename-Command">grantPoints</kbd>
method. This method implements the main interaction with the client.
When the first two bytes of the CAD ID in a request by a <kbd
 class="Filename-Command">JavaPurse</kbd> transaction correspond to the
two bytes of CAD ID in the corresponding Parameter Update APDU command,
the <kbd class="Filename-Command">grantPoints</kbd> method
implementing the <kbd class="Filename-Command">JavaLoyaltyInterface</kbd>
is requested.
</p>
<p class="Paragraph"><a name="pgfId-1002043"></a><kbd
 class="Filename-Command">JavaLoyalty</kbd> maintains the balance of
loyalty points. The applet contains methods to credit and debit the
account of points and to get and set the balance.
</p>
<p class="Paragraph"><a name="pgfId-1002044"></a>The <kbd
 class="Filename-Command">Wallet</kbd> applet demonstrates a simplified
cash card application. It keeps a balance, and exercises some of the
Java Card API features such as the use of a PIN to control access to
the applet.
</p>
<br>
<table dir="ltr" cellpadding="0" cellspacing="0" width="100%"
 summary="procedure">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td valign="baseline" rowspan="1" colspan="1" abbr="ProcIconTitle">
      <p class="Head3ProcTitle"><a name="pgfId-1002046"></a><img
 class="icon" title="procedure icon" alt="procedure icon"
 src="shared/downtriangle.gif">&nbsp;&nbsp;Running <kbd
 class="Filename-Command">demo1</kbd>
      </p>
      </td>
    </tr>
  </tbody>
</table>
<p class="Step1"><a name="pgfId-1002056"></a> 1. <strong>demo1 runs in
the Java Card WDE.</strong>Navigate to the <kbd
 class="Filename-Command">jcwde</kbd> directory.
</p>
<p class="StepPara1"><a name="pgfId-1002060"></a>This is <kbd
 class="Filename-Command">$JC_HOME/samples/src/demo/jcwde</kbd> on the
Solaris or Linux platform or <kbd class="Filename-Command">%JC_HOME%\samples\src\demo\jcwde</kbd>
on the Microsoft Windows platform. Enter the following command:
</p>
<pre class="Codeline"><a name="pgfId-1002064"></a>jcwde jcwde.app<br></pre>
<p class="Step1-"><a name="pgfId-1002065"></a> 2. Run <kbd
 class="Filename-Command">apdutool</kbd> in a separate window.
</p>
<p class="StepPara1"><a name="pgfId-1002066"></a>In a separate command
window, navigate to the <kbd class="Filename-Command">$JC_HOME/samples/src/demo/demo1</kbd>
directory on the Solaris or Linux platform or <kbd
 class="Filename-Command">%JC_HOME%\samples\src\demo\demo1</kbd> on the
Microsoft Windows platform and run <kbd class="Filename-Command">apdutool</kbd>
using the following command:
</p>
<pre class="Codeline"><a name="pgfId-1002070"></a>apdutool -nobanner -noatr demo1.scr &gt; demo1.scr.jcwde.out<br></pre>
<p class="Paragraph"><a name="pgfId-1002071"></a>If the run is
successful, the <kbd class="Filename-Command">apdutool</kbd> log, <kbd
 class="Filename-Command">demo1.scr.jcwde.out</kbd>, is identical to
the file <kbd class="Filename-Command">demo1.scr.expected.out</kbd>.
</p>
<h3 class="Head2"><a name="pgfId-1002096"></a><a name="34243"></a>Demo 2<a
 name="marker-1002095"></a></h3>
<p class="Paragraph"><a name="pgfId-1002097"></a>The Demo 2
demonstration, <kbd class="Filename-Command">demo2</kbd>, illustrates
downloading Java Card platform packages onto the card. This
demonstration contains the installer applet in the mask image. After
the card is powered up, the <kbd class="Filename-Command">Photocard</kbd>,
<kbd class="Filename-Command">SampleLibrary</kbd>, <kbd
 class="Filename-Command">JavaPurse</kbd>, <kbd
 class="Filename-Command">JavaLoyalty</kbd>, <kbd
 class="Filename-Command">Wallet</kbd>, <kbd class="Filename-Command">RMIDemo</kbd>,
and <kbd class="Filename-Command">SecureRMIDemo</kbd> packages are
downloaded. The commands from <kbd class="Filename-Command">demo1</kbd>
are repeated. Finally, the card is powered down.
</p>
<h4 class="Head3"><a name="pgfId-1002100"></a><a name="94486"></a>Running
<kbd class="Filename-Command">demo2</kbd><a name="marker-1002099"></a></h4>
<p class="Paragraph"><a name="pgfId-1002101"></a><kbd
 class="Filename-Command">demo2</kbd> runs in <kbd
 class="Filename-Command">cref</kbd> because the Java Card WDE is not
able to support the downloading of CAP files.
</p>
<p class="Step1"><a name="pgfId-1002102"></a> 1. Run <kbd
 class="Filename-Command">cref</kbd>.
</p>
<p class="StepPara1"><a name="pgfId-1002103"></a>Run <kbd
 class="Filename-Command">cref</kbd> using the following command:
</p>
<pre class="Codeline"><a name="pgfId-1002110"></a>cref -o demoee<br></pre>
<p class="Step1-"><a name="pgfId-1002119"></a> 2. Run <kbd
 class="Filename-Command">apdutool</kbd> in a separate window.
</p>
<p class="StepPara1"><a name="pgfId-1002120"></a>In a separate command
window, navigate to the <kbd class="Filename-Command">$JC_HOME/samples/src/demo/demo2</kbd>
directory on the Solaris or Linux platform or <kbd
 class="Filename-Command">%JC_HOME%\samples\src\demo\demo2</kbd> on the
Microsoft Windows platform and run <kbd class="Filename-Command">apdutool</kbd>
using the following command:
</p>
<pre class="Codeline"><a name="pgfId-1002124"></a>apdutool -nobanner -noatr demo2.scr &gt; demo2.scr.cref.out<br></pre>
<p class="StepPara1"><a name="pgfId-1002125"></a>If the run is
successful, the <kbd class="Filename-Command">apdutool</kbd> log, <kbd
 class="Filename-Command">demo2.scr.cref.out</kbd>, is identical to the
file <kbd class="Filename-Command">demo2.scr.expected.out</kbd>.
</p>
<p class="StepPara1"><a name="pgfId-1002126"></a>After <kbd
 class="Filename-Command">cref</kbd> completes executing, an EEPROM
image is stored in the file <kbd class="Filename-Command">demoee</kbd>.
For more information, refer to <a href="cJDKc-jcre.html#56321"
 class="XRef">Chapter 10</a>.
</p>
<h3 class="Head2"><a name="pgfId-1002153"></a><a name="86125"></a>Demo 3<a
 name="marker-1002152"></a></h3>
<p class="Paragraph"><a name="pgfId-1002154"></a>The Demo 3
demonstration, <kbd class="Filename-Command">demo3</kbd>, illustrates
the capabilities of a Java Card technology-enabled smart card to save
its state across sessions. After running <kbd class="Filename-Command">demo2</kbd>,
the state of the card can be saved. This card state must be used as the
initial state for running <kbd class="Filename-Command">demo3</kbd>. </p>
<br>
<table dir="ltr" cellpadding="0" cellspacing="0" width="100%"
 summary="procedure">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td valign="baseline" rowspan="1" colspan="1" abbr="ProcIconTitle">
      <p class="Head3ProcTitle"><a name="pgfId-1002156"></a><img
 class="icon" title="procedure icon" alt="procedure icon"
 src="shared/downtriangle.gif">&nbsp;&nbsp;Running <kbd
 class="Filename-Command">demo3</kbd><a name="marker-1002155"></a>
      </p>
      </td>
    </tr>
  </tbody>
</table>
<p class="Paragraph"><a name="pgfId-1002157"></a><kbd
 class="Filename-Command">demo3</kbd> must be run after <kbd
 class="Filename-Command">demo2</kbd>. <kbd class="Filename-Command">demo3</kbd>
runs in the <kbd class="Filename-Command">cref</kbd> because the
virtual machine state must be restored after the initial run.
</p>
<p class="Step1"><a name="pgfId-1002158"></a> 1. Run <kbd
 class="Filename-Command">cref</kbd>. </p>
<p class="StepPara1"><a name="pgfId-1002159"></a> Run <kbd
 class="Filename-Command">cref</kbd> using the following command:
</p>
<pre class="Codeline"><a name="pgfId-1002166"></a>cref -i demoee<br></pre>
<p class="StepPara1"><a name="pgfId-1002167"></a><kbd
 class="Filename-Command">cref</kbd> restores the EEPROM image from the
file <kbd class="Filename-Command">demoee</kbd>. For more information,
refer to <a href="cJDKc-jcre.html#56321" class="XRef">Chapter 10</a>.
</p>
<p class="Step1-"><a name="pgfId-1002171"></a> 2. Run <kbd
 class="Filename-Command">apdutool</kbd> in a separate window.
</p>
<p class="StepPara1"><a name="pgfId-1002172"></a>In a separate command
window, navigate to the <kbd class="Filename-Command">$JC_HOME/samples/src/demo/demo3</kbd>
directory on the Solaris or Linux platform or <kbd
 class="Filename-Command">%JC_HOME%\samples\src\demo\demo3</kbd> on the
Microsoft Windows platform and run <kbd class="Filename-Command">apdutool</kbd>,
using the following command:
</p>
<pre class="Codeline"><a name="pgfId-1002176"></a>apdutool -nobanner -noatr demo3.scr &gt; demo3.scr.cref.out<br></pre>
<p class="Paragraph"><a name="pgfId-1002177"></a>If the run is
successful, the <kbd class="Filename-Command">apdutool</kbd> log, <kbd
 class="Filename-Command">demo3.scr.cref.out</kbd>, is be identical to
the file <kbd class="Filename-Command">demo3.scr.expected.out</kbd>.
</p>
<h3 class="Head2"><a name="pgfId-1002207"></a><a name="27897"></a>Java
Card RMI Demo<a name="marker-1002206"></a></h3>
<p class="Paragraph"><a name="pgfId-1002208"></a>Every Java Card RMI
application consists of two parts: a card applet and a client program
communicating with it. In this case, the <kbd class="Filename-Command">RMIDemo</kbd>
applet is installed in EEPROM image when you run <kbd
 class="Filename-Command">demo2</kbd> on <kbd class="Filename-Command">cref</kbd>.
On Java Card WDE, the applets are included in the simulated mask.
</p>
<p class="Paragraph"><a name="pgfId-1002219"></a>The <kbd
 class="Filename-Command">RMIDemo</kbd> uses the card applet <kbd
 class="Filename-Command">PurseApplet</kbd>, the Purse interface and
its implementation <kbd class="Filename-Command">PurseImpl</kbd>.
These classes reside in the package <kbd class="Filename-Command">com.sun.javacard.samples.RMIDemo</kbd>.
The client-side program <kbd class="Filename-Command">PurseClient</kbd>
resides in the package <kbd class="Filename-Command">com.sun.javacard.clientsamples.purseclient</kbd>.
</p>
<p class="Paragraph"><a name="pgfId-1002220"></a>The Purse interface
describes the supported functionality: methods for obtaining the
account balance, debiting and crediting the account, and obtaining and
setting an account number. The interface also defines the constants
used for error reporting. The <kbd class="Filename-Command">PurseImpl</kbd>
class implements <kbd class="Filename-Command">Purse</kbd>. </p>
<p class="Paragraph"><a name="pgfId-1002222"></a>The card applet <kbd
 class="Filename-Command">PurseApplet</kbd> creates and registers
instances of the dispatcher and the Java Card RMI service. </p>
<p class="Paragraph"><a name="pgfId-1002223"></a>The client-side
program, <kbd class="Filename-Command">PurseClient</kbd>, represents a
simple Java Card RMI client. The program opens a connection with a
card, creates the Java Card RMI Connect instance, and selects the Java
Card applet (in this case, the <kbd class="Filename-Command">PurseApplet</kbd>).
The program then gets the initial reference from <kbd
 class="Filename-Command">PurseApplet</kbd> (the reference to an
instance of <kbd class="Filename-Command">PurseImpl</kbd>) and casts
it to the <kbd class="Filename-Command">Purse</kbd> interface type.
This allows <kbd class="Filename-Command">PurseImpl</kbd> to be
treated as a local object. The program can then exercise the card by
debiting and crediting different amounts, and by setting and getting
the account number. The program demonstrates error handling by
intentionally attempting to set an account number of incorrect size.
This causes a <kbd class="Filename-Command">UserException</kbd> to be
thrown with the appropriate error code. </p>
<p class="Paragraph"><a name="pgfId-1002224"></a>The client part of the
<kbd class="Filename-Command">RMIDemo</kbd> can be run without
parameters or with the <kbd class="Filename-Command">-i</kbd>
parameter: </p>
<ul>
  <li class="Bullet1"><a name="pgfId-1002225"></a>If the demo is run
without parameters, remote references are identified using the class
name of the remote object. </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1-"><a name="pgfId-1002226"></a>If the demo is run
with the <kbd class="Filename-Command">-i</kbd> parameter, remote
references are identified using the list of remote interfaces
implemented by the remote object.
  </li>
  <p class="Linebreak">
  </p>
</ul>
<p class="Paragraph"><a name="pgfId-1002230"></a>For more information
on these formats, see Chapter 8 of the <em class="Emphasis">Runtime
Environment Specification for the Java Card Platform, Version 2.2.2</em>.
</p>
<h4 class="Head3"><a name="pgfId-1110703"></a>Running the Java Card RMI
Demo<a name="marker-1110702"></a></h4>
<p class="Paragraph"><a name="pgfId-1110704"></a><kbd
 class="Filename-Command">RMIDemo</kbd> can be run on either <kbd
 class="Filename-Command">cref</kbd> or Java Card WDE. Before running
the demo, add to your CLASSPATH the directory <kbd
 class="Filename-Command">$JC_HOME/samples/src_client</kbd> on the
Solaris or Linux platform or <kbd class="Filename-Command">%JC_HOME%\samples\src_client</kbd>
on the Windows platform. This directory includes the source files for
the client portion of the demo. The script that runs this demo will
modify the CLASSPATH to include this directory. This demo uses the
configuration file <kbd class="Filename-Command">jcclient.properties</kbd>.
A sample <kbd class="Filename-Command">jcclient.properties</kbd> file
is available in the binary release bundles in <kbd
 class="Filename-Command">java_card_kit-2_2_2/samples/src_client</kbd>
for Solaris or Linux platforms and in <kbd class="Filename-Command">java_card_kit-2_2_2\samples\src_client</kbd>
on the Windows platform. </p>
<p class="Paragraph"><a name="pgfId-1110705"></a>On <kbd
 class="Filename-Command">cref</kbd>, <kbd class="Filename-Command">RMIDemo</kbd>
can be run only after <kbd class="Filename-Command">demo2</kbd> has
successfully completed. </p>
<p class="Paragraph"><a name="pgfId-1002236"></a>To run the <kbd
 class="Filename-Command">RMIDemo</kbd> applet in Java Card WDE, list
it on the first line of the applet configuration file <kbd
 class="Filename-Command">jcwde_rmi.app</kbd>.
</p>
<p class="Paragraph"><a name="pgfId-1002238"></a>If the run is
successful, the output in the file is the same as contained in file <kbd
 class="Filename-Command">rmidemo.scr.expected.out</kbd>. </p>
<br>
<table dir="ltr" cellpadding="0" cellspacing="0" width="100%"
 summary="procedure">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td valign="baseline" rowspan="1" colspan="1" abbr="ProcIconTitle">
      <p class="Head3ProcTitle"><a name="pgfId-1002239"></a><img
 class="icon" title="procedure icon" alt="procedure icon"
 src="shared/downtriangle.gif">&nbsp;&nbsp;Running <kbd
 class="Filename-Command">RMIDemo</kbd> on <kbd
 class="Filename-Command">cref</kbd>
      </p>
      </td>
    </tr>
  </tbody>
</table>
<p class="Step1"><a name="pgfId-1002240"></a> 1. Run <kbd
 class="Filename-Command">cref</kbd>.
</p>
<p class="StepPara1"><a name="pgfId-1002241"></a>Run <kbd
 class="Filename-Command">cref</kbd> using the following command:
</p>
<pre class="Codeline"><a name="pgfId-1002248"></a>cref -i demoee<br></pre>
<p class="Step1-"><a name="pgfId-1027150"></a> 2. Run the Java Card RMI
client program in a separate window.
</p>
<p class="StepPara1"><a name="pgfId-1002265"></a>Run the Java Card RMI
client program with either of these commands:
</p>
<pre class="Codeline"><a name="pgfId-1002272"></a>rmidemo &gt; rmidemo.scr.cref.out<br></pre>
<pre class="Codeline"><a name="pgfId-1002273"></a>rmidemo -i &gt; rmidemo.scr.cref.out<br></pre>
<br>
<table dir="ltr" cellpadding="0" cellspacing="0" width="100%"
 summary="procedure">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td valign="baseline" rowspan="1" colspan="1" abbr="ProcIconTitle">
      <p class="Head3ProcTitle"><a name="pgfId-1002274"></a><img
 class="icon" title="procedure icon" alt="procedure icon"
 src="shared/downtriangle.gif">&nbsp;&nbsp;Running <kbd
 class="Filename-Command">RMIDemo</kbd> on Java Card WDE: </p>
      </td>
    </tr>
  </tbody>
</table>
<p class="Step1"><a name="pgfId-1002275"></a> 1. Run Java Card WDE.
</p>
<p class="StepPara1"><a name="pgfId-1002276"></a>Run Java Card WDE
using the following command:
</p>
<p class="Paragraph"><a name="pgfId-1095377"></a>On Solaris or Linux
platform:
</p>
<pre class="Codeline"><a name="pgfId-1002283"></a>$JC_HOME/bin/jcwde jcwde_rmi.app<br></pre>
<p class="Paragraph"><a name="pgfId-1095424"></a>On Windows platform:
</p>
<pre class="Codeline"><a name="pgfId-1095425"></a>%JC_HOME%\bin\jcwde jcwde_rmi.app<br></pre>
<p class="Step1-"><a name="pgfId-1002284"></a> 2. Run the Java Card RMI
client program in a separate window.
</p>
<p class="StepPara1"><a name="pgfId-1002285"></a>In a separate command
window, navigate to the <kbd class="Filename-Command">$JC_HOME/samples/src/demo/demo2/rmi</kbd>
directory on the Solaris or Linux platform or <kbd
 class="Filename-Command">%JC_HOME%\samples\src\demo\demo2\rmi</kbd>
directory on the Microsoft Windows platform. Run the Java Card RMI
client program with either of these commands:
</p>
<pre class="Codeline"><a name="pgfId-1002292"></a>rmidemo &gt; rmidemo.scr.jcwde.out<br></pre>
<pre class="Codeline"><a name="pgfId-1002293"></a>rmidemo -i &gt; rmidemo.scr.jcwde.out<br></pre>
<h3 class="Head2"><a name="pgfId-1002296"></a><a name="38674"></a>Secure
Java Card RMI Demo<a name="marker-1002295"></a></h3>
<p class="Paragraph"><a name="pgfId-1002297"></a>Think of the secure
Java Card RMI demo, <kbd class="Filename-Command">SecureRMIDemo</kbd>,
as a version of the <kbd class="Filename-Command">RMIDemo</kbd> with
an added security service. <kbd class="Filename-Command">SecureRMIDemo</kbd>
uses the card applet <kbd class="Filename-Command">SecurePurseApplet</kbd>,
the <kbd class="Filename-Command">Purse</kbd> interface and its
implementation <kbd class="Filename-Command">SecurePurseImpl</kbd>,
and a definition of the security service <kbd class="Filename-Command">MySecurityService</kbd>.
These classes reside in the package <kbd class="Filename-Command">com.sun.javacard.samples.SecureRMIDemo</kbd>.
The demo also uses the client-side program <kbd
 class="Filename-Command">SecurePurseClient</kbd> and the specialized
card accessor <kbd class="Filename-Command">CustomCardAccessor</kbd>.
These classes reside in the package <kbd class="Filename-Command">com.sun.javacard.clientsamples.securepurseclient</kbd>.
</p>
<p class="Paragraph"><a name="pgfId-1002298"></a>The <kbd
 class="Filename-Command">Purse</kbd> interface is similar to the
interface used in the non-secure case, however, there is an extra
constant: <kbd class="Filename-Command">REQUEST_DENIED</kbd>. This
constant is used to report situations where the client tries to invoke
a method that it is not allowed to access. </p>
<p class="Paragraph"><a name="pgfId-1002299"></a>The <kbd
 class="Filename-Command">MySecurityService</kbd> class is a security
service that is responsible for ensuring data integrity by verifying
checksums on incoming commands and attaching checksums to outgoing
commands. The program also requires the client to authenticate itself
as the principal application provider or principal cardholder by
sending a two-byte PIN.
</p>
<p class="Paragraph"><a name="pgfId-1002300"></a>The implementation of <kbd
 class="Filename-Command">Purse</kbd>, <kbd class="Filename-Command">SecurePurseImpl</kbd>,
is similar to the non-secure case, however, at the beginning of each
method call, a call is made to the security service that ensures that
the business rules are satisfied and that the data is not corrupted.
</p>
<p class="Paragraph"><a name="pgfId-1002301"></a>The applet <kbd
 class="Filename-Command">SecurePurseApplet</kbd> is similar to the
non-secure case, but it also creates and registers an instance of <kbd
 class="Filename-Command">MySecurityService</kbd>. </p>
<p class="Paragraph"><a name="pgfId-1002302"></a>The client-side
program, <kbd class="Filename-Command">SecurePurseClient</kbd>, is
similar to the non-secure case, but instead of a generic card accessor,
it uses its own implementation, <kbd class="Filename-Command">CustomCardAccessor</kbd>,
which performs additional preprocessing and postprocessing of data and
supports the additional command <kbd class="Filename-Command">authenticateUser</kbd>.
</p>
<p class="Paragraph"><a name="pgfId-1002303"></a><kbd
 class="Filename-Command">SecurePurseClient</kbd> also requires
verification of the user. After the applet is inserted, a PIN must be
given to the card-side applet by calling <kbd class="Filename-Command">authenticateUser</kbd>
on <kbd class="Filename-Command">CustomCardAccessor</kbd>. </p>
<p class="Paragraph"><a name="pgfId-1002304"></a>When <kbd
 class="Filename-Command">authenticateUser</kbd> is called, <kbd
 class="Filename-Command">CustomCardAccessor</kbd> prepares and sends
the following command: </p>
<br>
<table class="Titled" border="1" bordercolorlight="#FFFFFF"
 bordercolordark="#000000" cellpadding="5" cellspacing="0" dir="ltr">
  <caption class="TableCaption"><a name="pgfId-1002308"> </a> TABLE
3-4 Authenticate User Command </caption>
  <thead><tr>
    <th scope="col" rowspan="1" colspan="1" bgcolor="#cccccc">
    <p class="TableHead"><a name="pgfId-1002322"></a>CLA_AUTH
    </p>
    </th>
    <th scope="col" rowspan="1" colspan="1" bgcolor="#cccccc">
    <p class="TableHead"><a name="pgfId-1002324"></a>INS_AUTH
    </p>
    </th>
    <th scope="col" rowspan="1" colspan="1" bgcolor="#cccccc">
    <p class="TableHead"><a name="pgfId-1002326"></a>P1 field
    </p>
    </th>
    <th scope="col" rowspan="1" colspan="1" bgcolor="#cccccc">
    <p class="TableHead"><a name="pgfId-1002328"></a>P2 field
    </p>
    </th>
    <th scope="col" rowspan="1" colspan="1" bgcolor="#cccccc">
    <p class="TableHead"><a name="pgfId-1002330"></a>LC field
    </p>
    </th>
    <th scope="col" rowspan="1" colspan="2" bgcolor="#cccccc">
    <p class="TableHead"><a name="pgfId-1002332"></a>PIN (two bytes)
    </p>
    </th>
  </tr>
  </thead>
  <tbody>
    <tr>
      <td scope="row" rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1002336"></a>0x80
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1002338"></a>0x39
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1002340"></a>0
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1002342"></a>0
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1002344"></a>2
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1002346"></a>xx
      </p>
      </td>
      <td rowspan="1" colspan="1">
      <p class="TableText"><a name="pgfId-1002348"></a>xx
      </p>
      </td>
    </tr>
  </tbody>
</table>
<br>
<p class="Paragraph"><a name="pgfId-1002350"></a>On the card side, <kbd
 class="Filename-Command">MySecurityService</kbd> processes the
command. If the PIN is correct, then the appropriate flags are set in
the security service and a confirmation response is returned to the
client. Once authentication is passed, the client program receives the
balance, credits the account, and again receives the balance. The
program demonstrates error handling when the client attempts to debit a
number of units from the account. This causes the program to throw a <kbd
 class="Filename-Command">UserException</kbd> with the code <kbd
 class="Filename-Command">REQUEST_DENIED</kbd>.
</p>
<p class="Paragraph"><a name="pgfId-1002351"></a>As with <kbd
 class="Filename-Command">RMIDemo</kbd>, the client part of the <kbd
 class="Filename-Command">SecureRMIDemo</kbd> can be run without
parameters or with the <kbd class="Filename-Command">-i</kbd>
parameter: </p>
<ul>
  <li class="Bullet1"><a name="pgfId-1002352"></a>If the demo is run
without parameters, remote references are identified using the class
name of the remote object. </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1-"><a name="pgfId-1002353"></a>If the demo is run
with the <kbd class="Filename-Command">-i</kbd> parameter, remote
references are identified using the list of remote interfaces
implemented by the remote object.
  </li>
  <p class="Linebreak">
  </p>
</ul>
<p class="Paragraph"><a name="pgfId-1002357"></a>For more information
on these formats, see Chapter 8 of the <em class="Emphasis">Runtime
Environment Specification for the Java Card Platform, Version 2.2.2</em>.
</p>
<h4 class="Head3"><a name="pgfId-1002360"></a>Running the Secure Java
Card RMI Demo<a name="marker-1002359"></a></h4>
<p class="Paragraph"><a name="pgfId-1110710"></a><kbd
 class="Filename-Command">SecureRMIDemo</kbd> can be run on either <kbd
 class="Filename-Command">cref</kbd> or Java Card WDE. Before running
the demo, add to your CLASSPATH the directory <kbd
 class="Filename-Command">$JC_HOME/samples/src_client</kbd> on the
Solaris or Linux platform or <kbd class="Filename-Command">%JC_HOME%\samples\src_client</kbd>
on the Windows platform. This directory includes the source files for
the client portion of the demo. The script that runs this demo will
modify the CLASSPATH to include this directory. This demo uses the
configuration file <kbd class="Filename-Command">jcclient.properties</kbd>.
A sample <kbd class="Filename-Command">jcclient.properties</kbd> file
is available in the binary release bundles in <kbd
 class="Filename-Command">java_card_kit-2_2_2/samples/src_client</kbd>
for Solaris or Linux platforms and in <kbd class="Filename-Command">java_card_kit-2_2_2\samples\src_client</kbd>
on the Windows platform.
</p>
<p class="Paragraph"><a name="pgfId-1106537"></a>The <kbd
 class="Filename-Command">SecureRMI</kbd> demo applet is installed in
the EEPROM image when you run <kbd class="Filename-Command">demo2</kbd>.
</p>
<p class="Paragraph"><a name="pgfId-1002362"></a>To run <kbd
 class="Filename-Command">SecureRMIDemo</kbd> in Java Card WDE, list it
on the first line of the applet configuration file <kbd
 class="Filename-Command">jcwde_securermi.app</kbd>.
</p>
<p class="StepPara1"><a name="pgfId-1002364"></a>If the run is
successful, the output in the file is the same as contained in file <kbd
 class="Filename-Command">securermidemo.scr.expected.out</kbd>. </p>
<br>
<table dir="ltr" cellpadding="0" cellspacing="0" width="100%"
 summary="procedure">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td valign="baseline" rowspan="1" colspan="1" abbr="ProcIconTitle">
      <p class="Head3ProcTitle"><a name="pgfId-1002365"></a><img
 class="icon" title="procedure icon" alt="procedure icon"
 src="shared/downtriangle.gif">&nbsp;&nbsp;Running <kbd
 class="Filename-Command">SecureRMIDemo</kbd> on <kbd
 class="Filename-Command">cref</kbd>
      </p>
      </td>
    </tr>
  </tbody>
</table>
<p class="Step1"><a name="pgfId-1002366"></a> 1. Run <kbd
 class="Filename-Command">cref</kbd>.
</p>
<p class="StepPara1"><a name="pgfId-1002367"></a>Run <kbd
 class="Filename-Command">cref</kbd> using the following command:
</p>
<pre class="Codeline"><a name="pgfId-1002374"></a>cref -i demoee<br></pre>
<p class="Step1-"><a name="pgfId-1027847"></a> 2. Run the Secure Java
Card RMI client program in a separate window.
</p>
<p class="StepPara1"><a name="pgfId-1027852"></a>Run the Secure Java
Card RMI client program with either of these commands:
</p>
<pre class="Codeline"><a name="pgfId-1002398"></a>securermidemo &gt; securermidemo.scr.cref.out<br></pre>
<pre class="Codeline"><a name="pgfId-1002399"></a>securermidemo -i &gt; securermidemo.scr.cref.out<br></pre>
<br>
<table dir="ltr" cellpadding="0" cellspacing="0" width="100%"
 summary="procedure">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td valign="baseline" rowspan="1" colspan="1" abbr="ProcIconTitle">
      <p class="Head3ProcTitle"><a name="pgfId-1002400"></a><img
 class="icon" title="procedure icon" alt="procedure icon"
 src="shared/downtriangle.gif">&nbsp;&nbsp;Running <kbd
 class="Filename-Command">SecureRMIDemo</kbd> on Java Card WDE:
      </p>
      </td>
    </tr>
  </tbody>
</table>
<p class="Step1"><a name="pgfId-1002401"></a> 1. Run Java Card WDE.
</p>
<p class="StepPara1"><a name="pgfId-1002402"></a>Navigate to the <kbd
 class="Filename-Command">jcwde</kbd> directory. This is <kbd
 class="Filename-Command">$JC_HOME/samples/src/demo/jcwde</kbd> on the
Solaris or Linux platform or <kbd class="Filename-Command">%JC_HOME%\samples\src\demo\jcwde</kbd>
on the Microsoft Windows platform. Run Java Card WDE using the
following command:
</p>
<pre class="Codeline"><a name="pgfId-1002409"></a>jcwde jcwde_securermi.app<br></pre>
<p class="Step1-"><a name="pgfId-1002410"></a> 2. Run the Secure Java
Card RMI client program in a separate window.
</p>
<p class="StepPara1"><a name="pgfId-1002411"></a>In a separate command
window, navigate to the <kbd class="Filename-Command">rmi</kbd>
directory. This is the <kbd class="Filename-Command">$JC_HOME/samples/src/demo/demo2/rmi</kbd>
directory on the Solaris or Linux platform or <kbd
 class="Filename-Command">%JC_HOME%\samples\src\demo\demo2\rmi </kbd>directory
on the Microsoft Windows platform. Run the Secure Java Card RMI client
program with either of these commands:
</p>
<pre class="Codeline"><a name="pgfId-1002418"></a>securermidemo &gt; securermidemo.jcwde.out<br></pre>
<pre class="Codeline"><a name="pgfId-1002419"></a>securermidemo -i &gt; securermidemo.jcwde.out<br></pre>
<h3 class="Head2"><a name="pgfId-1002506"></a><a name="92942"></a>Object
Deletion Demo 1<a name="marker-1002505"></a></h3>
<p class="Paragraph"><a name="pgfId-1002507"></a>The Object Deletion
Demo 1, <kbd class="Filename-Command">odDemo1</kbd>, demonstrates the
object deletion mechanism, applet deletion, and package deletion. The <kbd
 class="Filename-Command">odDemo1</kbd> demonstration has the following
three parts: </p>
<ul>
  <li class="Bullet1"><a name="pgfId-1002509"></a><kbd
 class="Filename-Command">odDemo1-1.scr</kbd> demonstrates the object
deletion mechanism and verifies that memory for objects referenced from
transient memory of type <kbd class="Filename-Command">CLEAR_ON_DESELECT</kbd>
is reclaimed after an applet is deselected. </li>
  <p class="Linebreak">
  </p>
</ul>
<p class="ParaIndent1"><a name="pgfId-1002510"></a><kbd
 class="Filename-Command">odDemo1-1.scr</kbd> does not depend on any
other demo. The final state of <kbd class="Filename-Command">cref</kbd>
memory must be saved to a file for <kbd class="Filename-Command">odDemo1-2.scr</kbd>
to use. </p>
<ul>
  <li class="Bullet1"><a name="pgfId-1002511"></a><kbd
 class="Filename-Command">odDemo1-2.scr</kbd> demonstrates the object
deletion mechanism and verifies that memory for objects referenced from
transient memory of type <kbd class="Filename-Command">CLEAR_ON_RESET</kbd>
is reclaimed after card reset.
  </li>
  <p class="Linebreak">
  </p>
</ul>
<p class="ParaIndent1"><a name="pgfId-1002512"></a>The <kbd
 class="Filename-Command">odDemo1-2.scr</kbd> demo must be run after <kbd
 class="Filename-Command">odDemo1-1.scr</kbd> because the initial state
of <kbd class="Filename-Command">cref</kbd> must be the same as its
final state after running <kbd class="Filename-Command">odDemo1-1.scr</kbd>.
After running <kbd class="Filename-Command">odDemo1-2.scr</kbd>, the
final state of <kbd class="Filename-Command">cref</kbd> must be saved
to a file so it can be used by <kbd class="Filename-Command">odDemo1-3.scr</kbd>.
</p>
<ul>
  <li class="Bullet1"><a name="pgfId-1002514"></a><kbd
 class="Filename-Command">odDemo1-3.scr</kbd> performs applet deletion,
package deletion, and employs the <kbd class="Filename-Command">AppletEvent.uninstall</kbd>
method to uninstall an applet. The demo verifies that all transient
memory of type <kbd class="Filename-Command">CLEAR_ON_RESET</kbd> and <kbd
 class="Filename-Command">CLEAR_ON_DESELECT</kbd> is returned to the
memory manager. The demo also demonstrates the use of the <kbd
 class="Filename-Command">AppletEvent.uninstall()</kbd> method.
  </li>
  <p class="Linebreak">
  </p>
</ul>
<p class="ParaIndent1"><a name="pgfId-1002515"></a>The <kbd
 class="Filename-Command">odDemo1-3.scr</kbd> demo must be run after <kbd
 class="Filename-Command">odDemo1-2.scr</kbd> because the initial state
of <kbd class="Filename-Command">cref</kbd> must be the same as its
final state after running <kbd class="Filename-Command">odDemo1-2.scr</kbd>.
</p>
<br>
<table dir="ltr" cellpadding="0" cellspacing="0" width="100%"
 summary="procedure">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td valign="baseline" rowspan="1" colspan="1" abbr="ProcIconTitle">
      <p class="Head3ProcTitle"><a name="pgfId-1002517"></a><img
 class="icon" title="procedure icon" alt="procedure icon"
 src="shared/downtriangle.gif">&nbsp;&nbsp;Running <kbd
 class="Filename-Command">odDemo1</kbd><a name="marker-1002516"></a>
      </p>
      </td>
    </tr>
  </tbody>
</table>
<p class="Paragraph"><a name="pgfId-1002518"></a><kbd
 class="Filename-Command">odDemo1</kbd> runs only in <kbd
 class="Filename-Command">cref</kbd>. This is because the Java Card WDE
does not support the object deletion mechanism, applet deletion, or
package deletion.
</p>
<p class="Step1"><a name="pgfId-1002519"></a> 1. In a command window,
run <kbd class="Filename-Command">cref</kbd>.
</p>
<p class="StepPara1"><a name="pgfId-1002520"></a>Use this command:
</p>
<pre class="Codeline"><a name="pgfId-1002521"></a>cref -o crefState <br></pre>
<p class="Step1-"><a name="pgfId-1002522"></a> 2. Run <kbd
 class="Filename-Command">apdutool</kbd> in a separate window.
</p>
<p class="StepPara1"><a name="pgfId-1002523"></a>In a second command
window, navigate to the <kbd class="Filename-Command">$JC_HOME/samples/src/demo/object_deletion</kbd>
directory on the Solaris or Linux platform or the <kbd
 class="Filename-Command">%JC_HOME%\samples\src\demo\object_deletion</kbd>
directory on the Microsoft Windows platform and run <kbd
 class="Filename-Command">apdutool</kbd>, using the following command:
</p>
<pre class="Codeline"><a name="pgfId-1002528"></a>apdutool -nobanner -noatr odDemo1-1.scr &gt; odDemo1-1.scr.cref.out <br></pre>
<p class="StepPara1"><a name="pgfId-1002529"></a>If the run is
successful, the <kbd class="Filename-Command">apdutool</kbd> log, <kbd
 class="Filename-Command">odDemo1-1.scr.cref.out</kbd> is identical to
the file <kbd class="Filename-Command">odDemo1-1.scr.expected.out</kbd>.
</p>
<p class="Step1-"><a name="pgfId-1002530"></a> 3. Run <kbd
 class="Filename-Command">cref</kbd> in the first command window.
</p>
<p class="StepPara1"><a name="pgfId-1002531"></a>Use this command:
</p>
<pre class="Codeline"><a name="pgfId-1002532"></a>cref -i crefState -o crefState <br></pre>
<p class="Step1-"><a name="pgfId-1002533"></a> 4. In the second command
window, execute <kbd class="Filename-Command">apdutool</kbd>.
</p>
<p class="StepPara1"><a name="pgfId-1002534"></a>Use this command:
</p>
<pre class="Codeline"><a name="pgfId-1002535"></a>apdutool -nobanner -noatr odDemo1-2.scr &gt; odDemo1-2.scr.cref.out <br></pre>
<p class="StepPara1"><a name="pgfId-1002536"></a>If the run is
successful, the <kbd class="Filename-Command">apdutool</kbd> log, <kbd
 class="Filename-Command">odDemo1-2.scr.cref.out</kbd>, is identical to
the file <kbd class="Filename-Command">odDemo1-2.scr.expected.out</kbd>.
</p>
<p class="Step1-"><a name="pgfId-1002537"></a> 5. Run <kbd
 class="Filename-Command">cref</kbd> in the first command window. </p>
<p class="StepPara1"><a name="pgfId-1002538"></a>Use this command:
</p>
<pre class="Codeline"><a name="pgfId-1002539"></a>cref -i crefState <br></pre>
<p class="Step1-"><a name="pgfId-1002540"></a> 6. In the second command
window, execute <kbd class="Filename-Command">apdutool</kbd>.
</p>
<p class="StepPara1"><a name="pgfId-1002541"></a>Use this command:
</p>
<pre class="Codeline"><a name="pgfId-1002542"></a>apdutool -nobanner -noatr odDemo1-3.scr &gt; odDemo1-3.scr.cref.out<br></pre>
<p class="StepPara1"><a name="pgfId-1002543"></a>If the run is
successful, the <kbd class="Filename-Command">apdutool</kbd> log, <kbd
 class="Filename-Command">odDemo1-3.scr.cref.out</kbd>, is identical to
the file <kbd class="Filename-Command">odDemo1-3.scr.expected.out</kbd>.
</p>
<h3 class="Head2"><a name="pgfId-1002546"></a><a name="93003"></a>Object
Deletion Demo 2<a name="marker-1002545"></a></h3>
<p class="Paragraph"><a name="pgfId-1002547"></a>The Object Deletion
Demo 2, <kbd class="Filename-Command">odDemo2</kbd>, demonstrates
package deletion and checks that persistent memory is returned to the
memory manager. This demo has one script, <kbd class="Filename-Command">odDemo2.scr</kbd>.
You do not have to run <kbd class="Filename-Command">odDemo1</kbd> to
run <kbd class="Filename-Command">odDemo2</kbd>.
</p>
<br>
<table dir="ltr" cellpadding="0" cellspacing="0" width="100%"
 summary="procedure">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td valign="baseline" rowspan="1" colspan="1" abbr="ProcIconTitle">
      <p class="Head3ProcTitle"><a name="pgfId-1002549"></a><img
 class="icon" title="procedure icon" alt="procedure icon"
 src="shared/downtriangle.gif">&nbsp;&nbsp;Running <kbd
 class="Filename-Command">odDemo2</kbd><a name="marker-1002548"></a>
      </p>
      </td>
    </tr>
  </tbody>
</table>
<p class="Paragraph"><a name="pgfId-1002550"></a><kbd
 class="Filename-Command">odDemo2</kbd> runs only in <kbd
 class="Filename-Command">cref</kbd>. This is because the Java Card WDE
does not support the object deletion mechanism, applet deletion, or
package deletion.
</p>
<p class="Step1"><a name="pgfId-1002551"></a> 1. In a command window,
run <kbd class="Filename-Command">cref</kbd>.
</p>
<p class="StepPara1"><a name="pgfId-1002552"></a>Use this command:
</p>
<pre class="Codeline"><a name="pgfId-1002553"></a>cref<br></pre>
<p class="Step1-"><a name="pgfId-1002554"></a> 2. Run <kbd
 class="Filename-Command">apdutool</kbd> in a second window.
</p>
<p class="StepPara1"><a name="pgfId-1002555"></a>In a second window,
navigate to the <kbd class="Filename-Command">$JC_HOME/samples/src/demo/object_deletion</kbd>
directory on the Solaris or Linux platform or the <kbd
 class="Filename-Command">%JC_HOME%\samples\src\demo\object_deletion</kbd>
directory on the Microsoft Windows platform and run <kbd
 class="Filename-Command">apdutool</kbd> with the following command: </p>
<pre class="Codeline"><a name="pgfId-1002559"></a>apdutool -nobanner -noatr odDemo2.scr &gt; odDemo2.scr.cref.out<br></pre>
<p class="StepPara1"><a name="pgfId-1002561"></a>If the run is
successful, the <kbd class="Filename-Command">apdutool</kbd> log, <kbd
 class="Filename-Command">odDemo2.scr.cref.out</kbd>, is identical to
the file <kbd class="Filename-Command">odDemo2.scr.expected.out</kbd>.
</p>
<h3 class="Head2"><a name="pgfId-1002564"></a><a name="13760"></a>Logical
Channels <a name="marker-1004369"></a>Demo</h3>
<p class="Paragraph"><a name="pgfId-1002565"></a>The Logical Channels
Demo, <kbd class="Filename-Command">lcdemo</kbd>, demonstrates the
behavior of Java Card technology-based logical channels by showing how
two applets that interact with each other can each be selected for use
at the same time. </p>
<p class="Paragraph"><a name="pgfId-1020168"></a>The applets may use a
contact based or contactless interface for communication with the
terminal. The Logical channel demo demonstrates the selection of an
applet on both the interfaces. The demo also demonstrates use of
ExtendedLength APDU.
</p>
<p class="Paragraph"><a name="pgfId-1002566"></a>The logical channels
demo mimics the behavior of a wireless device connected to a network
service. A connection manager tracks whether the device is connected to
the service and whether the connection is local or remote. </p>
<p class="Paragraph"><a name="pgfId-1020674"></a>While it is connected,
the user's account is debited on a unit of time basis. The debit rate
is based on whether the connection is local or remote, and uses either
the contacted or contactless interface. </p>
<p class="Paragraph"><a name="pgfId-1020286"></a>The demo employs two
applets to simulate this situation: The <kbd class="Filename-Command">ConnectionManager</kbd>
applet manages the connection, while the <kbd class="Filename-Command">AccountAccessor</kbd>
applet manages the account. </p>
<p class="Paragraph"><a name="pgfId-1020681"></a>When the user turns on
the device, the <kbd class="Filename-Command">ConnectionManager</kbd>
applet is selected. The <kbd class="Filename-Command">ConnectionManager</kbd>
implements the ExtendedLength interface to handle APDUs with larger
data segments such as the ones used for key exchange in the demo. Every
unit of time the terminal sends a message containing the area code to
the card. </p>
<p class="Paragraph"><a name="pgfId-1020682"></a>When the user wants to
use the service, the <kbd class="Filename-Command">AccountAccessor</kbd>
applet is selected on another logical channel so that the terminal can
query the balance. The <kbd class="Filename-Command">AccountAccessor</kbd>
can return the balance only if the <kbd class="Filename-Command">ConnectionManager</kbd>
is active. The <kbd class="Filename-Command">ConnectionManager</kbd>
applet sets the connection and tracks the connection status. Based on
the value of an area code variable, the <kbd class="Filename-Command">ConnectionManager</kbd>
determines whether the connection is local or remote. It also
determines whether the connection is contacted or contactless. <kbd
 class="Filename-Command">AccountAccessor</kbd> uses this information
to debit the account at the appropriate rate. The connection is
disabled when the user completes the call or when the account is
depleted.
</p>
<br>
<table dir="ltr" cellpadding="0" cellspacing="0" width="100%"
 summary="procedure">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td valign="baseline" rowspan="1" colspan="1" abbr="ProcIconTitle">
      <p class="Head3ProcTitle"><a name="pgfId-1002569"></a><img
 class="icon" title="procedure icon" alt="procedure icon"
 src="shared/downtriangle.gif">&nbsp;&nbsp;Running the Logical Channels<a
 name="marker-1004376"></a> Demo
      </p>
      </td>
    </tr>
  </tbody>
</table>
<p class="Paragraph"><a name="pgfId-1002570"></a>The logical channels
demo runs only in <kbd class="Filename-Command">cref</kbd>. No sample
scripts or demos are provided to demonstrate this functionality on Java
Card WDE.
</p>
<p class="Step1"><a name="pgfId-1002571"></a> 1. In a command window,
run <kbd class="Filename-Command">cref</kbd>.
</p>
<p class="StepPara1"><a name="pgfId-1002572"></a>Use this command:
</p>
<pre class="Codeline"><a name="pgfId-1002573"></a>cref <br></pre>
<p class="Step1-"><a name="pgfId-1002574"></a> 2. Run <kbd
 class="Filename-Command">apdutool</kbd> in a separate window.
</p>
<p class="StepPara1"><a name="pgfId-1002575"></a>In the second command
window, navigate to the <kbd class="Filename-Command">$JC_HOME/samples/src/demo/logical_channels</kbd>
directory on the Solaris or Linux platform or the <kbd
 class="Filename-Command">%JC_HOME%\samples\src\demo\logical_channels</kbd>
directory on the Microsoft Windows platform and execute apdutool using
the following command:
</p>
<pre class="Codeline"><a name="pgfId-1002579"></a>apdutool -nobanner -noatr channelDemo.scr &gt; channelDemo.scr.cref.out <br></pre>
<p class="StepPara1"><a name="pgfId-1033726"></a>If the run is
successful, the <kbd class="Filename-Command">apdutool</kbd> log, <kbd
 class="Filename-Command">channelDemo.scr.cref.out</kbd>, is identical
to the file <kbd class="Filename-Command">channelDemo.scr.expected.out</kbd>.
</p>
<h3 class="Head2"><a name="pgfId-1113300"></a><a name="65322"></a>Demo
2 Cryptography Demo<a name="marker-1113299"></a></h3>
<p class="Paragraph"><a name="pgfId-1113301"></a>The Demo 2
Cryptography Demo, <kbd class="Filename-Command">demo2crypto</kbd>, is
similar to <kbd class="Filename-Command">demo2</kbd>, except that it
employs a version of <kbd class="Filename-Command">JavaPurse</kbd>
that uses a DES MAC algorithm. This version of <kbd
 class="Filename-Command">JavaPurse</kbd> is called <kbd
 class="Filename-Command">JavaPurseCrypto</kbd>. All other applets are
exactly the same as were used in demo2. </p>
<br>
<hr noshade="noshade" size="1">
<table class="TipNote" dir="ltr" width="100%" summary="TipNote">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td rowspan="1" colspan="1" abbr="TipNoteText">
      <p class="TipNote"><b class="TipNote">Note - </b><a
 name="pgfId-1113302"></a>There are no cryptography versions of <kbd
 class="Filename-Command">demo1</kbd> or <kbd class="Filename-Command">demo3</kbd>.
      </p>
      </td>
    </tr>
  </tbody>
</table>
<hr noshade="noshade" size="1">
<br>
<p class="Paragraph"><a name="pgfId-1113303"></a>A DES MAC is a
cryptographic signature that uses DES encryption on all or part of a
message (APDU). <kbd class="Filename-Command">JavaPurseCrypto</kbd>
uses the DES MAC to verify several of the APDUs. Instead of zeros in
the signature currently in <kbd class="Filename-Command">JavaPurse</kbd>,
it contains a real signature that can be programmatically signed and
verified. Other programs that interact with <kbd
 class="Filename-Command">JavaPurseCrypto</kbd> (such as <kbd
 class="Filename-Command">JavaLoyalty</kbd> and <kbd
 class="Filename-Command">Wallet</kbd>) are not affected because all
signing and verifying of the signature occurs only within <kbd
 class="Filename-Command">JavaPurseCrypto</kbd>. </p>
<p class="Paragraph"><a name="pgfId-1113304"></a>For the Java Card
2.2.2 release, the demo 2 cryptography demo uses transient DES keys.
The use of transient DES keys by the demo is intended to highlight the
fact that the DES cryptography API has been enhanced to eliminate
persisent memory usage when transient DES keys are provided. The
elimination of the use of persistent memory when transient DES keys are
used will, in turn, provide better performance in a contactless applet.
</p>
<br>
<table dir="ltr" cellpadding="0" cellspacing="0" width="100%"
 summary="procedure">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td valign="baseline" rowspan="1" colspan="1" abbr="ProcIconTitle">
      <p class="Head3ProcTitle"><a name="pgfId-1113306"></a><img
 class="icon" title="procedure icon" alt="procedure icon"
 src="shared/downtriangle.gif">&nbsp;&nbsp;Running the <kbd
 class="Filename-Command">demo2crypto</kbd> Demo<a name="marker-1113305"></a>
      </p>
      </td>
    </tr>
  </tbody>
</table>
<p class="Paragraph"><a name="pgfId-1113307"></a><kbd
 class="Filename-Command">demo2crypto</kbd> runs in <kbd
 class="Filename-Command">cref</kbd> because the Java Card WDE is not
able to support the downloading of CAP files.
</p>
<p class="Step1"><a name="pgfId-1113308"></a> 1. Run <kbd
 class="Filename-Command">cref</kbd>.
</p>
<p class="StepPara1"><a name="pgfId-1113346"></a>Run <kbd
 class="Filename-Command">cref</kbd> using the following command:
</p>
<pre class="Codeline"><a name="pgfId-1113347"></a>cref <br></pre>
<p class="Step1-"><a name="pgfId-1113356"></a> 2. Run <kbd
 class="Filename-Command">apdutool</kbd> in a separate window.
</p>
<p class="StepPara1"><a name="pgfId-1113357"></a>In a second command
window, navigate to the <kbd class="Filename-Command">$JC_HOME/samples/src/demo/demo2</kbd>
directory on the Solaris or Linux platform or <kbd
 class="Filename-Command">%JC_HOME%\samples\src\demo\demo2</kbd> on
Windows and execute <kbd class="Filename-Command">apdutool</kbd> using
the following command:
</p>
<pre class="Codeline"><a name="pgfId-1113358"></a>apdutool -nobanner -noatr demo2crypto.scr &gt; demo2crypto.scr.cref.out<br></pre>
<p class="StepPara1"><a name="pgfId-1113359"></a>If the run is
successful, the <kbd class="Filename-Command">apdutool</kbd> log, <kbd
 class="Filename-Command">demo2crypto.scr.cref.out</kbd>, is identical
to the file <kbd class="Filename-Command">demo2crypto.scr.expected.out</kbd>.
</p>
<h3 class="Head2"><a name="pgfId-1037442"></a><a name="28577"></a>Photo
Card <a name="marker-1033731"></a>Demo</h3>
<p class="Paragraph"><a name="pgfId-1033733"></a>The Photo Card Demo, <kbd
 class="Filename-Command">photocard</kbd>, illustrates how you can use
the large address space available in the 32-bit version of the Java
Card platform reference implementation, version 2.2.2. The demo uses
the large address space of the smart card's EEPROM memory to store up
to four GIF images. The images are included with the demo.
</p>
<br>
<table dir="ltr" cellpadding="0" cellspacing="0" width="100%"
 summary="procedure">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td valign="baseline" rowspan="1" colspan="1" abbr="ProcIconTitle">
      <p class="Head3ProcTitle"><a name="pgfId-1002647"></a><img
 class="icon" title="procedure icon" alt="procedure icon"
 src="shared/downtriangle.gif">&nbsp;&nbsp;Running the Photo Card Demo
      </p>
      </td>
    </tr>
  </tbody>
</table>
<p class="Paragraph"><a name="pgfId-1002648"></a>The Photo Card demo
can be run only after <kbd class="Filename-Command">demo2</kbd>
successfully completes. This is because the Photo Card applet is
downloaded with <kbd class="Filename-Command">demo2.scr</kbd>. </p>
<p class="Paragraph"><a name="pgfId-1110784"></a>Before running the
demo, add to your CLASSPATH the directory <kbd class="Filename-Command">$JC_HOME/samples/src_client</kbd>
on the Solaris or Linux platform or <kbd class="Filename-Command">%JC_HOME%\samples\src_client</kbd>
on the Windows platform. This directory includes the source files for
the client portion of the demo. The script that runs this demo will
modify the CLASSPATH to include this directory. This demo uses the
configuration file <kbd class="Filename-Command">jcclient.properties</kbd>.
A sample <kbd class="Filename-Command">jcclient.properties</kbd> file
is available in the binary release bundles in <kbd
 class="Filename-Command">java_card_kit-2_2_2/samples/src_client</kbd>
for Solaris or Linux platforms and in <kbd class="Filename-Command">java_card_kit-2_2_2\samples\src_client</kbd>
on the Windows platform. </p>
<p class="Step1"><a name="pgfId-1002650"></a> 1. Run <kbd
 class="Filename-Command">cref</kbd> with the <kbd
 class="Filename-Command">-z</kbd> option.
</p>
<p class="StepPara1"><a name="pgfId-1002651"></a>Run <kbd
 class="Filename-Command">cref</kbd> with the <kbd
 class="Filename-Command">-z</kbd> option to display the memory
statistics for the card using the following command:
</p>
<pre class="Codeline"><a name="pgfId-1002658"></a>cref -z -i demoee<br></pre>
<p class="Step1-"><a name="pgfId-1002668"></a> 2. Run the <kbd
 class="Filename-Command">photocard</kbd> client program specifying the
supplied GIF images in a separate window.
</p>
<p class="StepPara1"><a name="pgfId-1002669"></a>In a separate window,
navigate to the <kbd class="Filename-Command">photocard</kbd>
directory. This is the <kbd class="Filename-Command">$JC_HOME/samples/src/demo/demo2/photocard</kbd>
directory on the Solaris or Linux platform or the <kbd
 class="Filename-Command">%JC_HOME%\samples\src\demo\demo2\photocar</kbd>d
directory on the Microsoft Windows platform. Run the <kbd
 class="Filename-Command">photocard</kbd> client program and specify
the four supplied GIF images with the following command:
</p>
<pre class="Codeline"><a name="pgfId-1002676"></a>photocard duke_magnify.gif duke_pencil.gif duke_wave.gif duke_thumbsup.gif &gt; photocard.scr.cref.out<br></pre>
<p class="StepPara1"><a name="pgfId-1084529"></a>If the run is
successful, the output in the file <kbd class="Filename-Command">photocard.scr.cref.out</kbd>
is the same as contained in file <kbd class="Filename-Command">photocard.scr.expected.out</kbd>.
</p>
<p class="Paragraph"><a name="pgfId-1084530"></a>For photo
verification, the Photocard Demo also includes the <kbd
 class="Filename-Command">verify</kbd> method. Photo verification
requires availability of the MessageDigest class and the SHA256
algorithm. The photo verification is based on the SHA256 Message Digest
algorithm. If the algorithm is provided, the <kbd
 class="Filename-Command">verify</kbd> method compares a photo provided
for verification with the ones on the card. If the algorithm is not
available, the <kbd class="Filename-Command">verify</kbd> method
indicates this.
</p>
<p class="Paragraph"><a name="pgfId-1084535"></a>In this case, if the
run is successful, the output in the file <kbd class="Filename-Command">photocard.scr.cref.out</kbd>
is the same as contained in the file <kbd class="Filename-Command">photocard.scr.expected.out.not_crypto</kbd>.
</p>
<p class="Step1-"><a name="pgfId-1020738"></a> 3. Perform a <kbd
 class="Filename-Command">diff</kbd> on the individual images to ensure
that their contents have not changed.
</p>
<h3 class="Head2"><a name="pgfId-1113469"></a><a name="80637"></a>Transit
System <a name="marker-1113468"></a>Demo</h3>
<p class="Paragraph"><a name="pgfId-1113470"></a>The transit system
demo, <kbd class="Filename-Command">transit</kbd>, illustrates a
contactless card-based transit applet. This demo consists of the
transit applet and two client applications, the <kbd
 class="Filename-Command">Point Of Sale</kbd> (POS) terminal client
application and the <kbd class="Filename-Command">Turnstile Transit</kbd>
terminal client application. </p>
<p class="Paragraph"><a name="pgfId-1113471"></a>A typical transit
scenario is pre-scripted in the <kbd class="Filename-Command">TransitDemo</kbd>
file, including crediting and checking the balance (a $99 initial
balance) on the transit card at the POS terminal, entering and exiting
the transit system through the <kbd class="Filename-Command">Turnstile
Transit</kbd> terminal (a $10 fee for the trip), and finally checking
the new balance (an $89 balance) on the transit card at the POS
terminal.
</p>
<br>
<table dir="ltr" cellpadding="0" cellspacing="0" width="100%"
 summary="procedure">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td valign="baseline" rowspan="1" colspan="1" abbr="ProcIconTitle">
      <p class="Head3ProcTitle"><a name="pgfId-1113472"></a><img
 class="icon" title="procedure icon" alt="procedure icon"
 src="shared/downtriangle.gif">&nbsp;&nbsp;Running the Transit System
Demo
      </p>
      </td>
    </tr>
  </tbody>
</table>
<p class="Paragraph"><a name="pgfId-1113473"></a>The <kbd
 class="Filename-Command">TransitDemo</kbd> or <kbd
 class="Filename-Command">TransitDemo.bat</kbd> script automatically
starts and stops <kbd class="Filename-Command">cref</kbd> when needed
to simulate interaction sessions with the POS terminal and the
turnstile transit terminal.
</p>
<p class="Step1"><a name="pgfId-1113474"></a> 1. Navigate to the <kbd
 class="Filename-Command">transit</kbd> directory.
</p>
<p class="Paragraph"><a name="pgfId-1113475"></a>In a separate window,
navigate to the <kbd class="Filename-Command">transit</kbd> directory.
This will be the <kbd class="Filename-Command">$JC_HOME/samples/src/demo/transit</kbd>
directory (on the Solaris or Linux platform) or <kbd
 class="Filename-Command">%JC_HOME%\samples\src\demo\transit</kbd>
directory (on the Microsoft Windows 2000 platform). </p>
<p class="Step1-"><a name="pgfId-1113476"></a> 2. Run the <kbd
 class="Filename-Command">TransitDemo</kbd> program.
</p>
<p class="Paragraph"><a name="pgfId-1113477"></a>To run the <kbd
 class="Filename-Command">TransitDemo</kbd> program, use the following
command: </p>
<p class="Paragraph"><a name="pgfId-1113478"></a><kbd
 class="Filename-Command">TransitDemo &gt; TransitDemo.out</kbd>
</p>
<p class="Paragraph"><a name="pgfId-1113479"></a>By default, the demo
uses transient session keys. If you specify the <kbd
 class="Filename-Command">-n</kbd> option, the demo does not use
transient session keys. </p>
<p class="Paragraph"><a name="pgfId-1113480"></a>If the run is
successful, the output in the file <kbd class="Filename-Command">TransitDemo.out</kbd>
is identical to the file <kbd class="Filename-Command">TransitDemo.expected.out</kbd>.
</p>
<h3 class="Head2"><a name="pgfId-1047468"></a><a name="38180"></a>Utility
APIs Demo Applet</h3>
<p class="Paragraph"><a name="pgfId-1047469"></a>The utility APIs demo
applet, <kbd class="Filename-Command">BrokerApplet</kbd>, demonstrates
how the newly introduced utility APIs can be used in an application.
This applet is a simple version of a hypothetical broker applet that is
used to assist the user in buying and selling stocks. The applet uses
constructed <a name="marker-1047470"></a>TLVs and primitive TLVs to
manage the portfolio. The communication with the broker is also in the
form of TLVs and uses the math API to determine the value of a trade.
It also uses the new integer API to construct an integer from byte
array and set integers in byte arrays for TLV objects.
</p>
<p class="Paragraph"><a name="pgfId-1035975"></a>This applet provides
the following features:
</p>
<ul>
  <li class="Bullet1"><a name="pgfId-1035976"></a>PIN protected access
to the application.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1035977"></a>Storage of portfolio
information on the card.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1035978"></a>Retrieval of complete
portfolio information from the card.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1035979"></a>Retrieval of
information on a particular stock in the portfolio.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1035980"></a>Assistance for the
user in creating a stock purchase request for the broker.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1035981"></a>Assistance the user
in creating a sell stock request for the broker.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1035982"></a>On receiving a trade
confirmation, update the portfolio accordingly.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1035983"></a>Get information on
current user account balance.
  </li>
  <p class="Linebreak">
  </p>
</ul>
<h4 class="Head3"><a name="pgfId-1035984"></a>PIN Protection</h4>
<p class="Paragraph"><a name="pgfId-1035985"></a>Uses the standard PIN
API in the Java Card platform to protect access to the applet. </p>
<h4 class="Head3"><a name="pgfId-1035986"></a>Storage of Portfolio</h4>
<p class="Paragraph"><a name="pgfId-1035987"></a>The applet uses a
portfolio constructed TLV to store the information regarding all the
stocks that the user currently holds. The information is stored in the
form of <kbd class="Filename-Command">stockInfo</kbd> constructed TLV.
Each <kbd class="Filename-Command">stockInfo</kbd> TLV contains the
following:
</p>
<ul>
  <li class="Bullet1-"><a name="pgfId-1035988"></a>Stock symbol
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1-"><a name="pgfId-1035989"></a>Number of stocks
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1-"><a name="pgfId-1035990"></a>Last Trade
Constructed TLV
  </li>
  <p class="Linebreak">
  </p>
  <ul>
    <li class="Bullet2-"><a name="pgfId-1035991"></a>Number of stocks
    </li>
    <p class="Linebreak">
    </p>
    <li class="Bullet2-"><a name="pgfId-1035992"></a>Stock Price
    </li>
    <p class="Linebreak">
    </p>
  </ul>
</ul>
<h4 class="Head3"><a name="pgfId-1035993"></a>Stock Trading</h4>
<p class="Paragraph"><a name="pgfId-1035994"></a>The applet assists the
user in buying and selling stocks by creating a "signed" purchasing or
selling request for the broker in the form of a stock purchase request
constructed TLV or sell stock request constructed TLV. Before the
request is generated, the applet checks to see if the user has enough
stocks in case the request is to sell the stock and enough account
balance if the request is to buy new stock. The request is sent back to
the terminal where the terminal application may retrieve the TLV from
the response APDU and send it to the broker. </p>
<p class="Paragraph"><a name="pgfId-1035995"></a>If the trade is
successful, the broker sends back a confirmation message in the form a
sell confirmation TLV or purchase confirmation TLV. The applet
retrieves the information from the confirmation TLV and updates the
portfolio as follows: </p>
<ul>
  <li class="Bullet1"><a name="pgfId-1035996"></a>If a new stock is
bought, the applet creates a new constructed <kbd
 class="Filename-Command">stockInfo</kbd> TLV to store the new stock
information. </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1035997"></a>If the user already
had a stock, the number of stocks the user currently holds, and the
last trade information is updated accordingly.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1035998"></a>If as a result of the
trade the user has 0 stocks of a certain company, the <kbd
 class="Filename-Command">stockInfo</kbd> TLV for that stock is removed
from the portfolio constructed TLV.
  </li>
  <p class="Linebreak">
  </p>
</ul>
<h4 class="Head3"><a name="pgfId-1035999"></a>Get Information On a Stock</h4>
<p class="Paragraph"><a name="pgfId-1036906"></a>User may use this
feature to get information regarding a specific stock rather than
retrieving the whole portfolio. If a stock is not found, the
appropriate exception is thrown. The information is returned in the
form of a <kbd class="Filename-Command">stockInfo</kbd> TLV that
contains the following:
</p>
<ul>
  <li class="Bullet1"><a name="pgfId-1036001"></a>Stock symbol
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1036002"></a>Number of stocks
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1036003"></a>Last trade
constructed TLV
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1036004"></a>Number of stocks
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1"><a name="pgfId-1036005"></a>Stock price
  </li>
  <p class="Linebreak">
  </p>
</ul>
<br>
<table dir="ltr" cellpadding="0" cellspacing="0" width="100%"
 summary="procedure">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td valign="baseline" rowspan="1" colspan="1" abbr="ProcIconTitle">
      <p class="Head3ProcTitle"><a name="pgfId-1038887"></a><img
 class="icon" title="procedure icon" alt="procedure icon"
 src="shared/downtriangle.gif">&nbsp;&nbsp;Running the BrokerApplet
Demo
      </p>
      </td>
    </tr>
  </tbody>
</table>
<p class="Paragraph"><a name="pgfId-1040332"></a>To run the <kbd
 class="Filename-Command">BrokerApplet</kbd> demo, you must have the
Java Card platform binary bundle in place. </p>
<p class="Step1"><a name="pgfId-1043462"></a> 1. If you are running
Solaris or Linux, run the <kbd class="Filename-Command">build_samples</kbd>
shell script.
</p>
<p class="Paragraph"><a name="pgfId-1043484"></a>Go to your <kbd
 class="Filename-Command">JC_HOME</kbd> directory and build samples by
running the <kbd class="Filename-Command">build_samples</kbd> shell
script. If <kbd class="Filename-Command">build_samples</kbd> completes
successfully, you should get a <kbd class="Filename-Command">utilitydemo.scr</kbd>
file in the <kbd class="Filename-Command">$JC_HOME/samples/src/demo/utilitydemo</kbd>
directory.
</p>
<p class="Step1-"><a name="pgfId-1043456"></a> 2. If you are running
Windows, run <kbd class="Filename-Command">build_samples.bat</kbd>.
</p>
<p class="Paragraph"><a name="pgfId-1043457"></a>Go to your <kbd
 class="Filename-Command">JC_HOME</kbd> directory and build samples by
running <kbd class="Filename-Command">build_samples.bat</kbd>. If <kbd
 class="Filename-Command">build_samples</kbd> completes successfully,
you should get a <kbd class="Filename-Command">utilitydemo.scr</kbd>
file in the <kbd class="Filename-Command">%JC_HOME%\samples\src\demo\utilitydemo</kbd>
directory.
</p>
<p class="Step1-"><a name="pgfId-1043483"></a> 3. Run <kbd
 class="Filename-Command">cref</kbd>.
</p>
<p class="Paragraph"><a name="pgfId-1043498"></a>In a separate window
run <kbd class="Filename-Command">cref</kbd> from the <kbd
 class="Filename-Command">$JC_HOME/bin</kbd> directory on Solaris and
Linux and from <kbd class="Filename-Command">%JC_HOME%\bin</kbd> on
Windows. </p>
<p class="Step1-"><a name="pgfId-1043516"></a> 4. Run the BrokerApplet
demo.
</p>
<p class="Paragraph"><a name="pgfId-1043517"></a>In the current window,
use one of the following commands to run the <kbd
 class="Filename-Command">BrokerApplet</kbd> demo.
</p>
<p class="Paragraph"><a name="pgfId-1043512"></a>On the Solaris and
Linux platforms:
</p>
<pre class="Codeline"><a name="pgfId-1043513"></a>$JC_HOME/bin/apdutool utilitydemo.scr &gt; utilitydemo.out<br></pre>
<p class="Paragraph"><a name="pgfId-1040334"></a>On the Windows
platform:
</p>
<pre class="Codeline"><a name="pgfId-1047044"></a>%JC_HOME%\bin\apdutool utilitydemo.scr &gt; utilitydemo.out<br></pre>
<p class="Paragraph"><a name="pgfId-1047052"></a>If the run is
successful, the output in the file <kbd class="Filename-Command">utilitydemo.out</kbd>
is the same as contained in file <kbd class="Filename-Command">utilitydemo.scr.expected.out</kbd>.
</p>
<h3 class="Head2"><a name="pgfId-1064095"></a><a name="48505"></a>Password
Biometric Sample Application<a name="marker-1064094"></a></h3>
<p class="Paragraph"><a name="pgfId-1064096"></a>The Password Biometric
Sample Application, <kbd class="Filename-Command">biometryDemo</kbd>,
illustrates the biometric APIs of type PASSWORD. In this demo, a user's
password is enrolled on the card and then a candidate password is
matched against the enrolled password.
</p>
<br>
<table dir="ltr" cellpadding="0" cellspacing="0" width="100%"
 summary="procedure">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td valign="baseline" rowspan="1" colspan="1" abbr="ProcIconTitle">
      <p class="Head3ProcTitle"><a name="pgfId-1064097"></a><img
 class="icon" title="procedure icon" alt="procedure icon"
 src="shared/downtriangle.gif">&nbsp;&nbsp;Running the Biometric Demo
      </p>
      </td>
    </tr>
  </tbody>
</table>
<p class="Paragraph"><a name="pgfId-1064098"></a>Use the following
commands to run the script.
</p>
<p class="Step1"><a name="pgfId-1064099"></a> 1. Run <kbd
 class="Filename-Command">cref</kbd>. </p>
<p class="StepPara1"><a name="pgfId-1064100"></a>Navigate to the
directory where you created an EEPROM image using <kbd
 class="Filename-Command">demo1</kbd> or <kbd class="Filename-Command">demo2</kbd>
(this is <kbd class="Filename-Command">$JC_HOME/samples/cref/demo1/32/tdual</kbd>
or <kbd class="Filename-Command">$JC_HOME/samples/cref/demo2/32/tdual</kbd>
on the Solaris or Linux platform or <kbd class="Filename-Command">%JC_HOME%\samples\cref\demo1\32\tdual</kbd>
or <kbd class="Filename-Command">%JC_HOME%\samples\cref\demo2\32\tdual</kbd>
on the Microsoft Windows platform). Run <kbd class="Filename-Command">cref</kbd>
using the following command:
</p>
<pre class="Codeline"><a name="pgfId-1064107"></a>cref<br></pre>
<p class="StepPara1"><a name="pgfId-1064108"></a><kbd
 class="Filename-Command">cref</kbd> restores the EEPROM image from the
file <kbd class="Filename-Command">demoee</kbd>. For more information,
refer to <a href="cJDKc-jcre.html#56321" class="XRef">Chapter 10</a>.
</p>
<p class="Step1-"><a name="pgfId-1064112"></a> 2. Run <kbd
 class="Filename-Command">apdutool</kbd> in a separate window.
</p>
<p class="StepPara1"><a name="pgfId-1065192"></a>In a separate command
window, navigate to the <kbd class="Filename-Command">$JC_HOME/samples/src/demo/biometry</kbd>
directory on the Solaris or Linux platform or <kbd
 class="Filename-Command">%JC_HOME%\samples\src\demo\biometry</kbd> on
the Microsoft Windows platform and run <kbd class="Filename-Command">apdutool</kbd>,
using the following command:
</p>
<p class="StepPara1"><a name="pgfId-1065255"></a>On the Solaris or
Linux platform:
</p>
<pre class="Codeline"><a name="pgfId-1065196"></a>$JC_HOME/bin/apdutool biometryDemo.scr &gt; biometryDemo.scr.cref.out<br></pre>
<p class="StepPara1"><a name="pgfId-1065228"></a>On the Windows
platform:
</p>
<pre class="Codeline"><a name="pgfId-1065229"></a>%JC_HOME%\bin\apdutool biometryDemo.scr &gt; biometryDemo.scr.cref.out<br></pre>
<p class="Paragraph"><a name="pgfId-1065226"></a>If the run is
successful, the output in the file <kbd class="Filename-Command">biometryDemo.scr.cref.out</kbd>
is the same as contained in file <kbd class="Filename-Command">biometryDemo.scr.expected.out</kbd>.
</p>
<h4 class="Head3"><a name="pgfId-1064121"></a>How the Biometric Sample
Works</h4>
<p class="Paragraph"><a name="pgfId-1064122"></a>The sequence of the
resulting events is as follows:
</p>
<p class="Step1"><a name="pgfId-1064123"></a> 1. The off-card tool
(this demo) takes a hard coded password and sends it to the card for
enrollment. The applet selected on-card is the SampleBioServer applet.
</p>
<p class="Step1-"><a name="pgfId-1064124"></a> 2. The SampleBioServer
applet stores the password as the reference template with a hard coded
number of tries allowed before block (5).
</p>
<p class="Step1-"><a name="pgfId-1064125"></a> 3. For matching, the
APDUscript asks the on-card client (SamplePasswdBioApplet) to ask the
SharedBioTemplate for the public template. For the purpose of this
sample, the public template would just contain the version number of
the implementation and the length of stored password representing the
requirement for password capture
</p>
<p class="Step1-"><a name="pgfId-1064126"></a> 4. The script then sends
for matching the same password used for enrollment. The card has a
matching algorithm and calculates the score based on the stored
password and received password. </p>
<p class="Step1-"><a name="pgfId-1064127"></a> 5. The card then returns
verification successful to the script.
</p>
<h4 class="Head3"><a name="pgfId-1064128"></a><kbd
 class="Filename-Command">SamplePasswdOwnerBioTemplate</kbd> Class</h4>
<p class="Paragraph"><a name="pgfId-1064129"></a>This class implements
the OwnerBioTemplate interface and is what the BioBuilder constructs
when asked for a OwnerBioTemplate interface for the <kbd
 class="Filename-Command">BioBuilder.PASSWORD</kbd> bio-type. This
class provides the enrollment and matching capability to clients. </p>
<h4 class="Head3"><a name="pgfId-1064130"></a><kbd
 class="Filename-Command">SamplePasswdBioServer</kbd> Class</h4>
<p class="Paragraph"><a name="pgfId-1064131"></a>This class represents
the BioServer applet on the card. It is responsible for communicating
with off-card clients with APDUs and with on-card client applets with
an implementation of <kbd class="Filename-Command">ShareableBioTemplate</kbd>
that it implements. This class causes the enrolling of the password
biometric while communicating with an off-card tool that sends the
password down to the BioServer. This class is also the interface to the
on-card and off-card clients for the biometric functionality on the
card.
</p>
<h4 class="Head3"><a name="pgfId-1064132"></a><kbd
 class="Filename-Command">SamplePasswdBioApplet</kbd> Class</h4>
<p class="Paragraph"><a name="pgfId-1064133"></a>This represents an
on-card client applet for the password biometric sample. It
communicates with an off-card tool to get the password and calls the <kbd
 class="Filename-Command">match</kbd> method on the
ShareableBioTemplate reference it gets from the Java Card runtime
environment, which is given the SamplePasswdBioServer applet AID.
</p>
<h4 class="Head3"><a name="pgfId-1064134"></a>Off-card Tool</h4>
<p class="Paragraph"><a name="pgfId-1064135"></a>For the sake of the
sample, the off-card tool is a simple <kbd class="Filename-Command">apdutool</kbd>
script which is used for both enrolling and matching.
</p>
<h4 class="Head3"><a name="pgfId-1064136"></a>Sequence Diagram Of How
The Sample Works</h4>
<p class="Paragraph"><a name="pgfId-1064137"></a>This sequence diagram
shows how the sample application uses the biometric API. <a
 href="cJDKdemo.html#64497" class="XRef">FIGURE 3-1</a> also includes
the sequence for enrolling the PASSWORD bio-template done by <kbd
 class="Filename-Command">SampleBioServer</kbd>. </p>
<p class="Paragraph"><a name="pgfId-1064141"></a>Note that the sequence
of steps depicted is the scenario used in the sample in which
everything works well. In other usages, there would be other sequences
of steps when things do not work well, such as when an error occurs
during the enrollment process, the matching process, the card-blocked
state, or the non-initialized state.
</p>
<a name="pgfId-1111579" style="font-weight: bold;"> </a><span
 style="font-weight: bold;"> FIGURE 3-1 </span><a name="64497"
 style="font-weight: bold;"> </a><span style="font-weight: bold;">
Biometric Sample Sequence Diagram </span><br>
<p class="FigureBox-Wide"><a name="pgfId-1064145"></a>
</p>
<p><img src="figures/cJDKdemo-5.jpg"
 title="This figure was explained before the caption."
 alt="This figure was explained before the caption." align="bottom"></p>
<a name="pgfId-1111349"></a>
<h4 class="Head3"><a name="pgfId-1064149"></a>How The Biometric API
Works</h4>
<p class="Paragraph"><a name="pgfId-1064150"></a>The biometric API is
designed to perform three basic functions, match biometric information
on-card, enroll users off-card and then transfer their information
on-card, and verify the user in a sequence of off-card and on-card
interactions.
</p>
<h5 class="Head4"><a name="pgfId-1064151"></a>On-card Matching</h5>
<p class="Paragraph"><a name="pgfId-1064152"></a>One of the
requirements of the architecture is that biometric verification must
happen on-card for security reasons. The card cannot send out a
person's biometric information for verification to be done off-card.
The reasoning here is the same as for a PIN, which is that it would not
be secure to do so.
</p>
<h5 class="Head4"><a name="pgfId-1064153"></a>Enrollment Process</h5>
<p class="Paragraph"><a name="pgfId-1064154"></a>During the enrollment
process, a person's biometric information is captured off-card and then
transferred on-card for storage and verification purpose. Since Java
Card technology-based cards are generally limited in their resources,
the entire data captured off-card is not sent to the card. What is sent
is a digested version of the biometric data and is very specific to a
particular algorithm. For the purpose of this sample, however, a
password is small enough that the entire password is transferred to the
card. </p>
<p class="Paragraph"><a name="pgfId-1101163"></a>The user-specific data
transferred makes up a reference template that is used later for
verification. At the end of the enrollment process, there also exists
an associated public template. The public template consists of
information for the off-card tool to capture the relevant information
from the user during verification. </p>
<p class="Paragraph"><a name="pgfId-1101164"></a>For example, in the
Precise Biometrics implementation of the fingerprint biometric API, the
public template contains the coordinates, relative to the reference
point for capturing fingerprint information. The off-card tool looks at
these coordinates and extracts that information from the user. In a
way, the public template defines the data requirements for
verification. For the purpose of this sample, the public template does
not contain any such specification since the entire password is
compared. In the sample, the public template just contains version
information.
</p>
<h5 class="Head4"><a name="pgfId-1064157"></a>Verification Process</h5>
<p class="Paragraph"><a name="pgfId-1064158"></a>During the
verification process the user enters his/her biometric information into
some sensor or input device. The information gathered from the user
input is defined by the public template as described above. This
information may be pre-processed off-card and is finally transferred to
the card for verification purposes. The on-card biometric application
then performs the verification given the reference template with
pre-existing user information and the new information that came in. The
steps are:
</p>
<p class="List1"><a name="pgfId-1064159"></a>1. The host issues a
verification request to the card.
</p>
<p class="List1-"><a name="pgfId-1064160"></a>2. The card sends back
the public template to the host.
</p>
<p class="List1-"><a name="pgfId-1064161"></a>3. The host captures the
user information and extracts from it the data defined by the public
template. The host may perform data-processing specific to the
biometric algorithm.
</p>
<p class="List1-"><a name="pgfId-1064162"></a>4. The host sends to the
card the extracted verification data.
</p>
<p class="List1-"><a name="pgfId-1064163"></a>5. The card matches the
captured data with its own representation stored in the reference
template. This matching process results in a score of how well the user
information matches the reference template information.
</p>
<p class="List1-"><a name="pgfId-1064164"></a>6. The card compares the
score with the threshold for acceptable criteria and returns the
verification result to the host.
</p>
<h4 class="Head3"><a name="pgfId-1064165"></a>Implementation Notes</h4>
<p class="Paragraph"><a name="pgfId-1064166"></a>For the Sun
Microsystems implementation of the password biometric, the following
restrictions apply:
</p>
<ul>
  <li class="Bullet1"><a name="pgfId-1064167"></a>The minimum password
length to be enrolled must be 5 bytes.
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1-"><a name="pgfId-1064168"></a>The maximum password
length to be enrolled must be 50 bytes.
  </li>
  <p class="Linebreak">
  </p>
</ul>
<p class="Paragraph"><a name="pgfId-1064169"></a>The array containing
password data during enrollment or matching must have the password laid
out as a byte array with each character represented by a byte starting
from index <kbd class="Filename-Command">offset</kbd>. There should be
no other information in the byte array from index <kbd
 class="Filename-Command">offset</kbd> to index <kbd
 class="Filename-Command">offset+length-1</kbd>. For example, password
"tests" must be represented by the byte array <kbd
 class="Filename-Command">{116, 101, 115, 116, 115}</kbd> starting at
index 0 with length 5.
</p>
<p class="Paragraph"><a name="pgfId-1064170"></a>The public template
for the stored password returned during a matching session is a byte
array (<kbd class="Filename-Command">dest</kbd>) with formatting as
shown below. The version for this implementation is 1.0.0, so the <kbd
 class="Filename-Command">dest</kbd> array would be as follows, where <kbd
 class="Filename-Command">&lt;passwd length&gt;</kbd> is a place holder
for the length of the password enrolled.
</p>
<ul>
  <li class="Bullet1"><a name="pgfId-1064171"></a><kbd
 class="Filename-Command">dest[0]=1</kbd>
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1-"><a name="pgfId-1064172"></a><kbd
 class="Filename-Command">dest[1]=0 </kbd>
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1-"><a name="pgfId-1064173"></a><kbd
 class="Filename-Command">dest[2]=0 </kbd>
  </li>
  <p class="Linebreak">
  </p>
  <li class="Bullet1-"><a name="pgfId-1064174"></a><kbd
 class="Filename-Command">dest[3] = &lt;passwd length&gt; </kbd>
  </li>
  <p class="Linebreak">
  </p>
</ul>
<h3 class="Head2"><a name="pgfId-1113486"></a><a name="36525"></a>SignatureMessageRecovery
Demo</h3>
<p class="Paragraph"><a name="pgfId-1113487"></a>Message recovery
refers to the mechanism whereby part of the message used to create the
message digest is also included as padding in the signature block.
During signature verification, the message data padding does not need
to be explicitly sent to the verifying entity, it can automatically be
extracted from the signature block.
</p>
<h4 class="Head3"><a name="pgfId-1113488"></a>Message Recovery Order of
Operations</h4>
<p class="Paragraph"><a name="pgfId-1113489"></a>This section describes
the order of operations for signing and verifying.
</p>
<h5 class="Head4"><a name="pgfId-1113490"></a>Signing</h5>
<p class="Paragraph"><a name="pgfId-1113491"></a>1.The user invokes a
combination of the update and sign methods to generate a signature
based on message data provided by the user.
</p>
<p class="Paragraph"><a name="pgfId-1113492"></a>2.The sign method
returns an indication to the user of the portion of the message that
was included as padding in the signature. This is required so that the
user knows what remaining data must still be sent along with the
signature block.
</p>
<h5 class="Head4"><a name="pgfId-1113493"></a>Verifying</h5>
<p class="Paragraph"><a name="pgfId-1113494"></a>1.The user initializes
the signature object with signature at the very beginning so it can get
the recoverable data at the earliest.
</p>
<p class="Paragraph"><a name="pgfId-1113495"></a>2.The user invokes a
combination of the update and verify methods to verify the signature
based on the message data provided by the user.
</p>
<p class="Paragraph"><a name="pgfId-1113496"></a>3.The verify method
verifies the signature by comparing the accumulated hash with the hash
in the message representative recovered during initialization.
</p>
<h4 class="Head3"><a name="pgfId-1113497"></a>Sample Application</h4>
<p class="Paragraph"><a name="pgfId-1113498"></a>This demo consists of
two scripts representing two scenarios for Signature with Message
Recovery. The first script, <kbd class="Filename-Command">sigMsgFullRec.scr</kbd>,
shows the scenario in which the message to sign is small enough that
the entire message itself becomes part of the signature padding (hence
the name "Full Recovery" since you can recover the full message from
the signature itself). The second script, <kbd class="Filename-Command">sigMsgPartRec.scr</kbd>,
demonstrates the scenario in which the message to sign is large enough
that only some part of it is included in the signature padding (hence
the name "Partial Recovery"). The scenarios are detailed below:
</p>
<h5 class="Head4"><a name="pgfId-1113499"></a>sigMsgFullRec.scr Script </h5>
<p class="Paragraph"><a name="pgfId-1113500"></a>The sequence of events
resulting from running this script are:
</p>
<p class="List1"><a name="pgfId-1113501"></a>1. The script sends to the
sample application a small message to sign.
</p>
<p class="List1-"><a name="pgfId-1113502"></a>2. The application
initializes the signature object with the algorithm <kbd
 class="Filename-Command">Signature.ALG_RSA_SHA_ISO9796_MR</kbd> and
signs the message. Because the message is small enough, the application
returns the signature data to the script.
</p>
<p class="List1-"><a name="pgfId-1113503"></a>3. The script then
simulates the verification phase in which it sends the signature data
to the sample application asking it to verify the message. </p>
<p class="Paragraph"><a name="pgfId-1113504"></a>The application
recovers the original message from the signature data and also verifies
the signature, then returns the original data back to the script. (If
the signature verification fails, it returns an error code).
</p>
<h5 class="Head4"><a name="pgfId-1113505"></a>sigMsgPartRec.scr Script </h5>
<p class="Paragraph"><a name="pgfId-1113506"></a>The sequence of events
resulting from running this script are:
</p>
<p class="List1"><a name="pgfId-1113507"></a>1. The script sends to the
sample application a large message to be signed.
</p>
<p class="List1-"><a name="pgfId-1113508"></a>2. The application
initializes the signature object with algorithm <kbd
 class="Filename-Command">Signature.ALG_RSA_SHA_ISO9796_MR</kbd> and
signs the message. Because the message is too large to fit in the
signature, the application returns back to the script the number of
bytes of original message that is embedded in the signature data. The
application also returns back to the script the signature data.
</p>
<p class="List1-"><a name="pgfId-1113509"></a>3. The script then
simulates the verification phase in which it sends the signature data
to the sample application.
</p>
<p class="List1-"><a name="pgfId-1113510"></a>4. The application
recovers the partial message and returns back to the script.
</p>
<p class="List1-"><a name="pgfId-1113511"></a>5. The script sends the
remainder of the message to the application to verify the signature.
</p>
<p class="List1-"><a name="pgfId-1113512"></a>6. The application
verifies the signature against the entire message and returns success.
</p>
<br>
<table dir="ltr" cellpadding="0" cellspacing="0" width="100%"
 summary="procedure">
  <colgroup span="1" width="100%"></colgroup><tbody>
    <tr align="left" valign="top">
      <td valign="baseline" rowspan="1" colspan="1" abbr="ProcIconTitle">
      <p class="Head3ProcTitle"><a name="pgfId-1113513"></a><img
 class="icon" title="procedure icon" alt="procedure icon"
 src="shared/downtriangle.gif">&nbsp;&nbsp;Running the Demo
      </p>
      </td>
    </tr>
  </tbody>
</table>
<p class="Paragraph"><a name="pgfId-1113514"></a>Use the following
commands to run the two scripts.
</p>
<p class="Step1"><a name="pgfId-1113515"></a> 1. Run <kbd
 class="Filename-Command">cref</kbd>. </p>
<p class="StepPara1"><a name="pgfId-1113516"></a>Navigate to the
directory where you created an EEPROM image using <kbd
 class="Filename-Command">demo1</kbd> or <kbd class="Filename-Command">demo2</kbd>
(this is <kbd class="Filename-Command">$JC_HOME/samples/cref/demo1/32/tdual</kbd>
or <kbd class="Filename-Command">$JC_HOME/samples/cref/demo2/32/tdual</kbd>
on the Solaris or Linux platform or <kbd class="Filename-Command">%JC_HOME%\samples\cref\demo1\32\tdual</kbd>
or <kbd class="Filename-Command">%JC_HOME%\samples\cref\demo2\32\tdual</kbd>
on the Microsoft Windows platform). Run <kbd class="Filename-Command">cref</kbd>
using the following command:
</p>
<pre class="Codeline"><a name="pgfId-1113523"></a>cref <br></pre>
<p class="StepPara1"><a name="pgfId-1113524"></a><kbd
 class="Filename-Command">cref</kbd> restores the EEPROM image from the
file <kbd class="Filename-Command">demoee</kbd>. For more information,
refer to <a href="cJDKc-jcre.html#56321" class="XRef">Chapter 10</a>.
</p>
<p class="Step1-"><a name="pgfId-1113528"></a> 2. To run <kbd
 class="Filename-Command">sigMsgFullRec.scr</kbd> or <kbd
 class="Filename-Command">sigMsgPartRec.scr</kbd>, run <kbd
 class="Filename-Command">apdutool</kbd> in separate windows.
</p>
<p class="StepPara1"><a name="pgfId-1113529"></a>To run <kbd
 class="Filename-Command">sigMsgFullRec.scr</kbd>, in a separate
command window, navigate to <kbd class="Filename-Command">$JC_HOME/samples/src/demo/demo-sigMsgFullRec</kbd>
on the Solaris or Linux platform or <kbd class="Filename-Command">%JC_HOME%\samples\src\demo\demo-sigMsgFullRec</kbd>
on the Microsoft Windows platform and run <kbd class="Filename-Command">apdutool</kbd>
using the following command:
</p>
<p class="Paragraph"><a name="pgfId-1113533"></a>On the Solaris or
Linux platform:
</p>
<pre class="Codeline"><a name="pgfId-1113534"></a>$JC_HOME/bin/apdutool -nobanner -noatr sigMsgFullRec.scr &gt; sigMsgFullRec.scr.cref.out<br></pre>
<p class="Paragraph"><a name="pgfId-1113535"></a>On the Windows
platform:
</p>
<pre class="Codeline"><a name="pgfId-1113536"></a>%JC_HOME%\bin\apdutool -nobanner -noatr sigMsgFullRec.scr &gt; sigMsgFullRec.scr.cref.out<br></pre>
<p class="StepPara1"><a name="pgfId-1113537"></a>To run <kbd
 class="Filename-Command">sigMsgPartRec.scr</kbd>, follow step 1 to
restart <kbd class="Filename-Command">cref</kbd>. In a separate
command window navigate to <kbd class="Filename-Command">$JC_HOME/samples/src/demo/demo-sigMsgPartRec.scr</kbd>
on the Solaris or Linux platform or <kbd class="Filename-Command">%JC_HOME%\samples\src\demo\demo-sigMsgPartRec</kbd>
on the Microsoft Windows platform and run <kbd class="Filename-Command">apdutool</kbd>
using the following command:
</p>
<p class="Paragraph"><a name="pgfId-1113541"></a>On the Solaris or
Linux platform:
</p>
<pre class="Codeline"><a name="pgfId-1113542"></a>$JC_HOME/bin/apdutool -nobanner -noatr <kbd
 class="Filename-Command">sigMsgPartRec.scr</kbd> &gt; <kbd
 class="Filename-Command">sigMsgPartRec.scr</kbd>.cref.out<br></pre>
<p class="Paragraph"><a name="pgfId-1113543"></a>On the Windows
platform:
</p>
<pre class="Codeline"><a name="pgfId-1113544"></a>%JC_HOME%\bin\apdutool -nobanner -noatr sigMsgPartRec.scr &gt; sigMsgPartRec.scr.cref.out<br></pre>
<p class="Paragraph"><a name="pgfId-1113545"></a>If the run is
successful, demo output in <kbd class="Filename-Command">sigMsgFullRec.scr.cref.out</kbd>
and <kbd class="Filename-Command">sigMsgPartRec.scr.cref.out</kbd> is
the same as contained in the files <kbd class="Filename-Command">sigMsgFullRec.scr.expected.out</kbd>
and <kbd class="Filename-Command">sigMsgPartRec.scr.expected.out</kbd>,
respectively.
</p>
<p class="Paragraph"><a name="pgfId-1111342"></a>&nbsp;
</p>
<p class="Paragraph"><a name="pgfId-1035702"></a>&nbsp;
</p>
<div class="navbar" align="center">
<br>
<br>
<table dir="ltr"
 summary="Navigation bar, includes the book title and navigation buttons"
 width="100%" cellpadding="0" cellspacing="0" border="0">
  <colgroup span="3" width="100%"><col id="1" span="1" width="45%"><col
 id="2" span="1" width="25%"><col id="3" span="1" width="30%"></colgroup><tbody>
    <tr bgcolor="#cccccc">
      <td class="navbartitle" align="left" rowspan="1" colspan="1"
 abbr="ChapTitle">&nbsp;&nbsp;Development Kit User's Guide, Java Card
Platform, Version 2.2.2
      </td>
      <td class="navbartitle" align="right" rowspan="1" colspan="1"
 abbr="PartNum">3-14-06
      </td>
      <td valign="top" align="right" rowspan="1" colspan="1"
 abbr="NavButtons"><a href="index.html"><img src="shared/toc01.gif"
 title="Table Of Contents" alt="Table Of Contents" width="30"
 height="26" border="0"></a><a href="cJDKinstall.html"><img
 src="shared/prev01.gif" title="Previous Chapter" alt="Previous Chapter"
 width="30" height="26" border="0"></a><a href="cJDKjcwde.html"><img
 src="shared/next01.gif" title="Next Chapter" alt="Next Chapter"
 width="30" height="26" border="0"></a><a href="ix.html"><img
 src="shared/index01.gif" title="Book Index" alt="Book Index" width="30"
 height="26" border="0"></a>
      </td>
    </tr>
  </tbody>
</table>
<br>
<br>
</div>
<p class="copyrightlink"><a href="copyright.html">Copyright</a> &copy;
2005, Sun Microsystems, Inc. All Rights Reserved.</p>
</body>
</html>
